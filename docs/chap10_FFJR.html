<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; FFJR – Empirical Research in Accounting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap11_BB1968.html" rel="next">
<link href="./chap09_import.html" rel="prev">
<link href="./img/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-9b8c35769f744c2f4ed0637cc337dad3.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-9b8c35769f744c2f4ed0637cc337dad3.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2e202cc42da04891ccbfde12644a5e33.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-19051c3445f577572871aeb7f709dfac.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "一致なし",
    "search-matching-documents-text": "一致した文書",
    "search-copy-link-title": "検索へのリンクをコピー",
    "search-hide-matches-text": "追加の検索結果を非表示",
    "search-more-match-text": "追加の検索結果",
    "search-more-matches-text": "追加の検索結果",
    "search-clear-button-title": "消去",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "検索",
    "search-label": "サーチ"
  }
}</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta name="twitter:title" content="3&nbsp; FFJR – Empirical Research in Accounting">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="サイドバーを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap10_FFJR.html">資本市場研究</a></li><li class="breadcrumb-item"><a href="./chap10_FFJR.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">FFJR</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="サイドバーを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="サーチ" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Empirical Research in Accounting</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/ma2ura/ER4A/" title="ソースコード" class="quarto-navigation-tool px-1" aria-label="ソースコード"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="ダークモードの切り替え"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="リーダーモードの切り替え">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="サーチ"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">序論</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap01_Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">はじめに</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap09_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">データを読み込む</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">資本市場研究</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap10_FFJR.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">FFJR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap11_BB1968.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ball and Brown (1968)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap12_Beaver1968.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Beaver (1968)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap13_Event.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">イベント・スタディ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap15_accruals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">アクルーアル</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap16_em.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">利益マネジメント</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap17_Natural.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">自然実験</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap18_Causal_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">因果メカニズム</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">因果推論</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">追加的なトピック</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">付録</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appA_LinearAlgebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">線形代数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appB_SQL.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">SQL入門</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appC_Computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">研究のためのコンピュータ概論</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">目次</h2>
   
  <ul>
<li><a href="#%E5%8A%B9%E7%8E%87%E7%9A%84%E5%B8%82%E5%A0%B4%E4%BB%AE%E8%AA%AC" id="toc-効率的市場仮説" class="nav-link active" data-scroll-target="#%E5%8A%B9%E7%8E%87%E7%9A%84%E5%B8%82%E5%A0%B4%E4%BB%AE%E8%AA%AC"><span class="header-section-number">3.1</span> 効率的市場仮説</a></li>
  <li><a href="#%E6%A0%AA%E5%BC%8F%E5%88%86%E5%89%B2" id="toc-株式分割" class="nav-link" data-scroll-target="#%E6%A0%AA%E5%BC%8F%E5%88%86%E5%89%B2"><span class="header-section-number">3.2</span> 株式分割</a></li>
  <li><a href="#%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E8%AA%B2%E9%A1%8C" id="toc-ディスカッション課題" class="nav-link" data-scroll-target="#%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E8%AA%B2%E9%A1%8C"><span class="header-section-number">3.3</span> ディスカッション課題</a></li>
  <li>
<a href="#%E9%85%8D%E5%BD%93%E6%94%BF%E7%AD%96" id="toc-配当政策" class="nav-link" data-scroll-target="#%E9%85%8D%E5%BD%93%E6%94%BF%E7%AD%96"><span class="header-section-number">3.4</span> 配当政策</a>
  <ul class="collapse">
<li><a href="#%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E8%AA%B2%E9%A1%8C-1" id="toc-ディスカッション課題-1" class="nav-link" data-scroll-target="#%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E8%AA%B2%E9%A1%8C-1"><span class="header-section-number">3.4.1</span> ディスカッション課題</a></li>
  </ul>
</li>
  <li>
<a href="#ffjr%E3%81%AE%E5%86%8D%E7%8F%BE" id="toc-ffjrの再現" class="nav-link" data-scroll-target="#ffjr%E3%81%AE%E5%86%8D%E7%8F%BE"><span class="header-section-number">3.5</span> FFJRの再現</a>
  <ul class="collapse">
<li><a href="#%E9%85%8D%E5%BD%93%E3%83%87%E3%83%BC%E3%82%BF" id="toc-配当データ" class="nav-link" data-scroll-target="#%E9%85%8D%E5%BD%93%E3%83%87%E3%83%BC%E3%82%BF"><span class="header-section-number">3.5.1</span> 配当データ</a></li>
  <li><a href="#%E8%AD%B0%E8%AB%96%E3%81%AE%E5%95%8F%E9%A1%8C%E3%81%A8%E6%BC%94%E7%BF%92" id="toc-議論の問題と演習" class="nav-link" data-scroll-target="#%E8%AD%B0%E8%AB%96%E3%81%AE%E5%95%8F%E9%A1%8C%E3%81%A8%E6%BC%94%E7%BF%92"><span class="header-section-number">3.5.2</span> 議論の問題と演習</a></li>
  </ul>
</li>
  <li><a href="#%E4%BC%9A%E8%A8%88%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E8%B3%87%E6%9C%AC%E5%B8%82%E5%A0%B4%E7%A0%94%E7%A9%B6" id="toc-会計における資本市場研究" class="nav-link" data-scroll-target="#%E4%BC%9A%E8%A8%88%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E8%B3%87%E6%9C%AC%E5%B8%82%E5%A0%B4%E7%A0%94%E7%A9%B6"><span class="header-section-number">3.6</span> 10.5 会計における資本市場研究</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap10_FFJR.html">資本市場研究</a></li><li class="breadcrumb-item"><a href="./chap10_FFJR.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">FFJR</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">FFJR</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!-- The (brief!) introduction in Fama et al. (1969) (“FFJR”) confirms that the goal of the paper is to shed light on market efficiency.  --><p>Fama et al.&nbsp;(1969)（以下、FFJR）の冒頭（簡潔なものではあるが）は、本論文の目的が市場の効率性（market efficiency）を明らかにすることであると確認している。 <!-- Prior empirical work had inferred “market efficiency from the observed independence of successive price changes.”  --> それまでの実証研究では、「連続する価格変化の独立性」が観察されることから市場の効率性を推測していた。 <!-- In contrast, FFJR focuses on the “speed of adjustment of prices to specific kinds of new information … [specifically] the information (if any) that is implicit in a stock split.”  --> これに対し、FFJR は「特定の新しい情報に対する価格調整の速度」に着目している。 具体的には、「株式分割（stock split）に内在する情報（もし存在するならば）に対する市場の反応」を分析している。 <!-- We start this chapter with a brief introduction to the efficient markets hypothesis. --> 本章では、まず<strong>効率的市場仮説</strong>(efficient markets hypothesis)の簡単な導入から始める。</p>
<!-- To examine their research question, FFJR conduct one of the earliest event studies.  -->
<p>FFJRは最も初期のイベント・スタディ（event study）の一つを実施した研究である。 <!-- Event studies have a tight connection with notions of efficient markets, especially the “semi-strong” form of the hypothesis offered by Fama (1970), which in turn has important implications for the study of accounting information in capital markets.  --> イベント・スタディは、効率的市場の概念、とりわけ Fama (1970) による「セミストロング型（semi-strong form）」効率性仮説と密接な関係があり、資本市場における会計情報の研究にも重要な示唆を与える。 <!-- Thus we use FFJR to provide an initial introduction to event studies, which we revisit in more depth in Chapter 13. --> したがって、本章ではFFJRを用いてイベント・スタディの基本概念を紹介し、第13章でより詳しく取り上げる。 <!-- We also use this chapter to introduce the reader to important additional data sets on CRSP, such as those related to dividends and stock splits, and to some R functions for efficiently manipulating data and models (e.g., the unnest() function from the tidyr package).  --></p>
<p>また、本章では、CRSP（Center for Research in Security Prices）の重要な追加データセット（配当や株式分割に関連するデータなど）を紹介し、データやモデルを効率的に操作するためのR関数（例えば、<code>tidyr</code>パッケージの<code>unnest()</code>関数）も取り上げる。 <!-- To better understand FFJR, we also provide some background on stock splits and dividends.  --> FFJRをよりよく理解するために、株式分割と配当に関する背景情報も提供する。 <!-- We then conduct a replication of FFJR and provide exercises for the reader. We conclude the chapter with a guide to this part of the book. --> 続いて、FFJRの結果を再現（replication）し、読者向けの演習を用意する。 本章の最後には、本書のこの部分へのガイドを示す。</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<!-- The code in this chapter uses the packages listed below.  -->
<p>この章のRコードは次のパッケージを利用している。 <!-- For instructions on how to set up your computer to use the code found in this book, see Section 1.2.  --> 本書に書かれているコードを利用するために自身のコンピューターの設定を行う方法は，1.2節を参照せよ。 <!-- Quarto templates for the exercises below are available on GitHub. --> 練習問題のためのQuartoテンプレートは，GitHubで利用できる。</p>
</div>
</div>
</div>
<section id="効率的市場仮説" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="効率的市場仮説">
<span class="header-section-number">3.1</span> 効率的市場仮説</h2>
<!-- One of the core ideas in capital market research is the efficient markets hypothesis (EMH).  -->
<p>資本市場研究の中心的なアイデアの1つは、効率的市場仮説(EMH)である。 <!-- Fama (1991) defines the EMH as “the simple statement that security prices fully reflect all available information.”  --> Fama (1991)は、EMHを「証券価格がすべての利用可能な情報を完全に反映している」というシンプルな記述で定義している。 <!-- The EMH is perhaps the most empirically tested proposition in all of social sciences. --> EMHは、おそらく社会科学全体で最も実証的に検証された命題である。</p>
<!-- In Fama’s formulation, the terms fully reflect and all available information are doing a lot of work.  -->
<p>Famaの定式化では、「完全に反映している」と「すべての利用可能な情報」の用語が多くの役割を果たしている。 <!-- One widely understood implication of the notion that security prices fully reflect a piece of information is that there are no opportunities to generate risk-adjusted profits by trading on that information.1 --> ある情報が証券価格に完全に反映されているという概念の広く理解されている帰結の1つは、その情報に基づいて取引することでリスク調整済み利益を生み出す機会がないということである。<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<!-- [^1]: Another deeper implication of the EMH is that prices should be “correct” in some sense. -->
<!-- The EMH is particularly important for accounting research and practice for at least two reasons.  -->
<p>EMHは、少なくとも2つの理由で会計研究と実践にとって特に重要である。 <!-- First, accounting information is often a component of “all available information” against which the EMH is tested.  --> 第1に、会計情報は、EMHが検証される「すべての利用可能な情報」の一部であることが多い。 <!-- In particular, Beaver (1998, p.136) points out that accounting earnings “are widely analyzed by the investment community.  --> 具体的には、Beaver (1998, p.136)が、会計利益は「投資コミュニティによって広く分析されている」と指摘している。 <!-- No other firm-specific variable receives more attention by the analysts and other capital market participants than earnings.”  --> 他の企業固有の変数は、アナリストや他の資本市場参加者によって利益よりも多くの注意を受けていない。 <!-- Second, whether the EMH holds or not has significant implications for preparers, zusers, and regulators of accounting information. --> 第2に、EMHが成立するかどうかは、会計情報の作成者、利用者、および規制当局にとって重要な意味を持つ。</p>
<!-- Richard Thaler identifies two notions of the EMH, which he labels the “price is right” and “no free lunch” principles.  -->
<p>Richard Thalerは、EMHの2つの概念を特定し、「価格は正しい」(price is right)と「無料のランチはない」(no free lunch)という原則とラベルを付けている。 <!-- The “price is right” principle says asset prices will “fully reflect” available information and thus “provide accurate signals for resource allocation”.  --> 「価格は正しい」原則は、資産価格が利用可能な情報を「完全に反映」し、したがって「資源配分のための正確なシグナルを提供する」と述べている。 <!-- The “no free lunch” principle holds that market prices are impossible to predict making it very hard for an investor to beat the market after taking account of risk.  --> 「無料のランチはない」原則は、市場価格を予測することは不可能であり、リスクを考慮した後に市場を上回る投資家を見つけることは非常に困難であると述べている。 <!-- The “no free lunch” principle is the variant that is both less demanding of market foresight and more empirically testable. --> 「無料のランチはない」原則は、市場の先見の明を要求されることが少なく、実証的に検証可能な変種である。</p>
<!-- Most empirical studies of the EMH test the “no free lunch” principle.  -->
<p>EMHのほとんどの実証的研究は、「無料のランチはない」原則を検証している。 <!-- However, Shiller (1984) laments the existence of “claims that because real returns are nearly unforecastable, the real price of stocks is close to the intrinsic value” and suggest that “this argument for the efficient markets hypothesis represents one of the most remarkable errors in the history of economic thought” (1984, p.459).  --> しかし、Shiller (1984)は、「現実のリターンがほとんど予測不可能であるため、現実の株価は内在価値に近い」という主張が存在することを嘆き、「この効率的市場仮説の議論は、経済思想史上で最も注目すべき誤りの1つを表している」と述べている。 <!-- In other words, a common fallacy is to conflate the two variants so that evidence for the “no free lunch” variant is adduced as supporting the “price is right” theory. --> 言い換えれば、一般的な誤謬は、2つの変種を混同し、その結果、「無料のランチはない」変種の証拠が「価格は正しい」理論を支持するとされる。</p>
<!-- The “price is right” theory often underlies papers that use event studies to evaluate the merits of corporate policies or regulation.  -->
<p>「価格は正しい」理論は、企業の政策や規制のメリットを評価するためにイベント・スタディを使用する論文の基礎となることがよくある。 <!-- We will discuss some issues with conflation of these two principles in Chapter 13. --> これら2つの原則を混同することに関するいくつかの問題については、第13章で議論する。</p>
<!-- ## Stock splits -->
</section><section id="株式分割" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="株式分割">
<span class="header-section-number">3.2</span> 株式分割</h2>
<!-- Because much about FFJR and its setting is implicit rather than explicit and might not be clear to a reader entering the field more than fifty years later, we first elucidate some elements of the paper. -->
<p>FFJRとその設定については、明示的でなく暗黙的であり、50年以上後にこの分野に入る読者には明確でないかもしれないため、まず論文のいくつかの要素を明らかにする。</p>
<!-- Walker (2021, p.1) describes a stock split as “the issuance of an additional number of shares, at no cost to the shareholder, in proportion to the number of shares already owned. -->
<p>Walker (2021, p.1)は，株式分割を「株主がすでに所有している株式の数に比例して、追加の株式を無償で発行すること」と説明している。 <!-- For example, a 2-for-1 split is implemented by a firm issuing one new share for each existing share, thereby doubling the total number of shares outstanding.” --> たとえば、2対1の株式分割は、企業が既存の株式に対して新しい株式を1株発行することで、発行済み株式の総数を倍増させる。</p>
<!-- From a fundamental perspective, a stock split might appear to have no economic consequences. -->
<p>ファンダメンタルの観点からは、株式分割には経済的な影響がないように見えるかもしれない。 <!-- Suppose we hold 1,000 shares in a company with an intrinsic value of $500 million and 10 million shares outstanding. --> たとえば、1,000株を保有しているとし、その会社の内在価値が5億ドルで、発行済み株式が1,000万株であるとする。 <!-- Our shares would be worth $50,000 (). --> 私たちの株式は50,000ドルの価値があるだろう（<span class="math inline">1000 \times 500 \div 10</span>）。 <!-- If the company then does a 2-for-1 split so that it now has 20 million shares outstanding, we would have 2,000 shares worth $50,000 (). --> その後、会社が2対1の株式分割を行い、発行済み株式が2,000万株になったとすると、私たちは2,000株を保有し、50,000ドルの価値があるだろう（<span class="math inline">2000 \times 500 \div 20</span>）。</p>
<!-- As such, it seems natural to ask why firms engage in stock splits. -->
<p>このように、企業が株式分割を行う理由を尋ねるのは自然なことである。 <!-- One explanation posits that, even though there is no underlying effect of a stock splits on the intrinsic value of the firm, markets are not efficient and the stock does not properly adjust for the change in the number of shares, leading to our hypothetical stock holding being worth (say) more than $50,000 after the split. --> ある説明は、株式分割が企業の内在価値に影響を与えないにもかかわらず、市場が効率的でないため、株式が株式数の変更に適切に調整されず、仮想的な株式保有が分割後に50,000ドル以上の価値になる可能性があると主張している。 <!-- If managers would prefer the firm to have a higher stock market value, this would be a reason to do a stock split.2 --> もし経営者が企業の株価を高くしたいと考えているなら、株式分割を行う理由になるだろう。<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<!-- [^2]: In some cases, managers might benefit from a lower post-split stock market value, say, if they want to purchase shares themselves after the split. -->
<!-- But if we assume market efficiency (and being able to calculate the stock-price impact of a stock split is surely a modest level of efficiency), we need to find alternative explanations for stock splits. -->
<p>しかし、市場効率性を仮定すると（株式分割の株価への影響を計算できることは、確かに効率性の控えめなレベルである）、株式分割の代替的な説明を見つける必要がある。 <!-- Walker (2021, p.2) identifies “two leading explanations”. --> Walker (2021, p.2)は、「2つの主要な説明」を特定している。</p>
<!-- The first explanation is the information-signalling hypothesis, which posits that “management uses the split as a channel to signal their private information about the firm’s positive outlook” (Walker, 2021, p.2). -->
<p>第1の説明は，情報シグナリング仮説であり，「経営陣が企業の前向きな見通しに関する非公開情報をシグナルするための手段として分割を利用する」と主張している（Walker, 2021, p.2）。 <!-- But this is a non-explanation unless there is some underlying effect of a split that is differentially beneficial or costly for firms with private information. --> しかし，これは，非公開情報を持つ企業にとって有益であるかコストがかかるような分割の基礎となる効果がある場合にのみ説明となる。 <!-- For example, a signalling equilibrium might be sustained if a stock split is less costly for firms with better prospects.3  --> たとえば、シグナリング均衡は、株式分割が見込みが良い企業にとってコストが低い場合に維持されるかもしれない。<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <!-- But we need to account for such differences in costs. --> しかし、そのようなコストの違いを考慮する必要がある。</p>
<!-- [^3]: For more on signalling theory, see Chapter 17 of Kreps (1990). -->
<!-- The second explanation is the liquidity hypothesis, which “posits that management use a split as a way to improve their stock’s liquidity” (Walker, 2021, p.2). -->
<p>第2の説明は、流動性仮説であり、「経営陣が株式分割を利用して株式の流動性を向上させる手段として利用する」と主張している（Walker, 2021, p.2）。 <!-- Delving into the detailed explanations of a liquidity effect of splits would take us too far away from the objectives of this chapter, so we offer a more stylized account that is adequate for our purposes here. --> 株式分割の流動性効果の詳細な説明に入ることは、この章の目的から遠ざかりすぎるため、ここでは目的に適したよりスタイライズされた説明を提供する。 <!-- We can label this account as a kind of Goldilocks stock price theory whereby a firm’s liquidity is maximized when its stock price trades in a certain range - neither too high nor too low - and that firms tend split their shares if doing so gets their stock prices into this range. --> この説明を、企業の流動性が特定の範囲で最大化されるときに、株価がその範囲にトレードされると、企業は株式を分割する傾向があるというゴルディロックスの株価理論としてラベル付けすることができる。 <!-- For example, if a company’s liquidity is maximized with a stock price around $40, but it is trading at around $80, then a 2-for-1 split would enhance liquidity. --> たとえば，企業の流動性が株価が40ドル前後のときに最大化されるが，実際には80ドル前後で取引されている場合，2対1の株式分割は流動性を向上させるだろう。</p>
<!-- The liquidity hypothesis might fill the gap we identified in the information-signalling hypothesis. -->
<p>流動性仮説は、情報シグナリング仮説で特定したギャップを埋めるかもしれない。 <!-- If a firm expects to trade at $100 in the future (due to inside information that will come to light later), it might want to do a 2-for-1 split, as a stock at $40 rising to $50 will enjoy better liquidity. --> 将来100ドルで取引されることを期待している企業（後で明らかになる内部情報による）は、2対1の株式分割を行いたいと考えるかもしれない。なぜなら、40ドルから50ドルに上昇する株式は流動性が向上するからである。 <!-- But a firm that has inside information and expects to trade closer to $40 in the future (without a split) would be reluctant to do a 2-for-1 split, as it would then expect to trade closer to $20 in the future, and thus would have worse liquidity. --> しかし、内部情報を持ち、将来40ドルに近い価格で取引されることを期待している企業（分割を行わない場合）は、2対1の株式分割を行うことに消極的であるだろう。なぜなら、その後は将来20ドルに近い価格で取引されることを期待しているからである。</p>
<!-- An important element of an event study is the identification of the period during which the market is expected to react to the event information. -->
<p>イベント研究の重要な要素の1つは、市場がイベント情報に反応すると予想される期間の特定である。 <!-- Like dividends, stock splits will generally be announced prior to their effective date. --> 配当と同様に、株式分割は通常、有効日の前に発表される。 <!-- Fama et al.(1969, p.7) “define month $0$ as the month in which the effective date of a split occurs”. --> Fama et al.&nbsp;(1969, p.7)は、「分割の有効日が発生する月を月 <span class="math inline">0</span> と定義する」と述べている。 <!-- Fama et al. (1969, p. 9) mention that for “a random sample of fifty-two splits” from their sample “the median time between the announcement date and the effective date of the split was 44.5 days.”  --> Fama et al.&nbsp;(1969, p.&nbsp;9)は、サンプルからの「52の分割の無作為なサンプル」について、「分割の発表日と有効日の中央値は44.5日であった」と述べている。 <!-- If there is information content in stock splits, we would expect an efficient market to react when the split is announced, not when it is effective. --> 株式分割に情報が含まれている場合、効率的な市場では、分割が発表されたときに反応することが期待される。 <!-- The analyses in FFJR use monthly data, so a median announcement date for splits of 44.5 days before the effective date implies that the median split is announced in month $-2$.--> FFJRの分析は月次データを使用しているため、分割の中央値の発表日が有効日の44.5日前であることから、中央値の分割は月 <span class="math inline">-2</span> に発表されることを意味する。 <!-- FFJR do not provide details on the distribution of split announcement dates, but some splits may be announced in month $-1$ , while others could occur in month $-3$ or even earlier.--> FFJRは、分割の発表日の分布についての詳細を提供していないが、一部の分割は月 <span class="math inline">-1</span> に発表されるかもしれず、他の分割は月 <span class="math inline">-3</span> またはそれ以前に発生するかもしれない。</p>
</section><section id="ディスカッション課題" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="ディスカッション課題">
<span class="header-section-number">3.3</span> ディスカッション課題</h2>
<!-- Consider the following alternative theories. -->
<p>以下の代替理論を考えてみよう。</p>
<!-- - **Theory A**: Firms like to keep their stock price within certain bounds.  -->
<ul>
<li>
<strong>理論A</strong>: 企業は株価を一定の範囲内に保ちたいと考えている。 <!-- When the stock price rises above a certain threshold, a firm may initiate a split, announcing it several weeks in advance of its effective date.  --> 株価がある閾値を超えると、企業は分割を開始し、有効日の数週間前に発表するかもしれない。 <!-- Firms do not use splits to signal private information about firm prospects. --> 企業は、分割を行うことで企業の見通しに関する非公開情報をシグナルするために使用しない。 <!-- - **Theory B**: Firms use splits to signal private information about firm prospects.  -->
</li>
<li>
<strong>理論B</strong>: 企業は、企業の見通しに関する非公開情報をシグナルするために分割を使用する。 <!-- A firm will announce a split several weeks in advance of its effective date. --> 企業は、有効日の数週間前に分割を発表する。</li>
</ul>
<!-- - Theory C: Capital market participants don’t fully adjust for the effect of splits, tending to anchor on the pre-split price to some degree.  --><ul>
<li>
<strong>理論C</strong>: 資本市場参加者は、分割の効果に完全に適応せず、ある程度前の株価にアンカーを置く傾向がある。 <!-- Firms do not use splits to signal private information about firm prospects. --> 企業は、分割を行うことで企業の見通しに関する非公開情報をシグナルするために使用しない。</li>
</ul>
<!-- Produce a set of indicative plots (e.g., drawn by hand) for the predicted behaviour of cumulative abnormal returns for assuming that the split is announced in month $-2$.  --><p>分割が月 <span class="math inline">-2</span> に発表されたと仮定して、累積異常収益の予測される挙動の一連の指標プロット（例：手描き）を作成する。 <!-- What impact would variation in the announcement dates relative to the split effective date have on the plots? --> 発表日の変動が分割の有効日に対する影響はどうなるか？</p>
<!-- ## Dividend policy -->
</section><section id="配当政策" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="配当政策">
<span class="header-section-number">3.4</span> 配当政策</h2>
<!-- Black (1976, p. 9) points out that the “Miller-Modigliani theory … says that the dividends a corporation pays do not affect the value of its shares or the returns to investors.”  -->
<p>Black (1976, p.9)は，ミラー・モディリアーニの理論によると企業が支払う配当は株価あるいは株式リターンに影響を与えない，と指摘している。 <!-- Of course, assumptions underlying the Miller-Modigliani theory include the absence of tax effects or transaction costs. --> もちろん，ミラー・モディリアーニの理論の基礎となる仮定は，税効果と取引コストが存在しない，というものがる。 <!-- While these assumptions are violated in reality, the violations generally do not provide an explanation for the existence of dividends (e.g., dividends are generally treated unfavourably for tax purposes). --> 現実ではこれらの仮定は違反している一方で，この違反は一般的に配当の存在に対する説明を提供しない（たとえば，一般的に配当は税目的で優遇されない）。</p>
<!-- Black (1976, p. 10) summarizes the common understanding of dividends: “For one reason or another, managers and directors do not like to cut the dividend. -->
<p>Black (1976, p.10)は，配当に関する一般的な理解をまとめている。「何らかの理由で，経営者や取締役は配当を削減したくない。–&gt; <!-- So they will raise the dividend only if they feel the company’s prospects are good enough to support the higher dividend for some time. --> そのため，会社の見通しが一定期間にわたって高い配当を支持するのに十分であると感じる場合にのみ，配当を引き上げる。–&gt; <!-- And they cut the dividend only if they think the prospects for a quick recovery are poor.”  --> そして，見通しがすぐに回復する可能性が低いと考える場合にのみ，配当を削減する。」–&gt; <!-- While this theory is “behavioural” (see Thaler, 2015, p. 166, for discussion of this), it has real teeth because managers and directors have inside information and therefore, if they act in accordance with this theory, dividend policy will convey some of this information. --> この理論は「行動的」であるが（これについてはThaler, 2015, p.166を参照）、経営者や取締役は内部情報を持っているため、この理論に従って行動すると、配当政策はその情報の一部を伝えることになる。</p>
<!-- Fama et al. (1969, pp.2–3) endorse this account of dividends: “Studies … have demonstrated that, once dividends have been increased, large firms show great reluctance to reduce them, except under the most extreme conditions. -->
<p>Fama et al.&nbsp;(1969, pp.2–3)は，配当に関するこの説明を支持している。「研究によると，一度配当が増加すると，大企業は最も極端な状況を除いて，それらを削減することに非常に消極的であることが示されている。–&gt; <!-- Directors have appeared to hedge against such dividend cuts by increasing dividends only when they are quite sure of their ability to maintain them in the future, i.e., only when they feel strongly that future earnings will be sufficient to maintain the dividends at their new higher rate. --> 取締役は，将来の利益が新しい高い率で配当を維持するのに十分であると確信しているときにのみ，配当を増やすことで，そのような配当削減に対するヘッジを行っているように見える。 <!-- Thus dividend changes may be assumed to convey important information to the market concerning management’s assessment of the firm’s long-run earning and dividend paying potential.” --> したがって，配当の変更は，経営陣が企業の長期的な収益と配当支払いの潜在能力をどのように評価しているかに関する市場への重要な情報を伝えるものと見なすことができる。</p>
<!-- The connection between stock splits and dividends is not spelt out clearly in FFJR. -->
<p>株式分割と配当の関係は，FFJRでは明確に説明されていない。 <!-- Fama et al. (1969, p. 2) do say that “in the past a large fraction of stock splits have been followed closely by dividend increases.”  --> Fama et al.&nbsp;(1969, p.&nbsp;2)は，「過去には，株式分割の大部分が直後に配当の増加に続いている」と述べている。 <!-- Fama et al. (1969, pp. 12–16) offer the following explanation: “When a split is announced or anticipated, the market interprets this (and correctly so) as greatly improving the probability that dividends will soon be substantially increased. --> Fama et al.&nbsp;(1969, pp.&nbsp;12–16)は，次の説明を提供している。「分割が発表されるか予想されると，市場はこれを（正しく）配当がすぐに大幅に増加する可能性が大幅に高まると解釈する。 <!-- (In fact, … in many cases the split and dividend increase will be announced at the same time.)” --> （実際には，多くの場合，分割と配当の増加は同時に発表されることがある。）」</p>
<!-- Several assumptions are buried in that explanation, which appears to be based on some kind of signalling story.4 -->
<p>この説明にはいくつかの仮定が含まれており，何らかのシグナリングの物語に基づいているように見える。<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> <!-- For example, why would firms signal future dividend increases using stock splits? --> たとえば，なぜ企業は株式分割を使用して将来の配当増加をシグナルするのか？ <!-- And, what are firms signalling with splits when they announce splits and dividend increases at the same time? --> また、分割と配当の増加を同時に発表するとき、企業は何をシグナルしているのか？</p>
<!-- 10.3.1 Discussion questions -->
<section id="ディスカッション課題-1" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="ディスカッション課題-1">
<span class="header-section-number">3.4.1</span> ディスカッション課題</h3>
<!-- 1. Does the research design of FFJR include the use of a control group? If so, how?  -->
<ol type="1">
<li>FFJRのリサーチ・デザインでは、コントロールグループを利用しているか？もしそうなら、どのように利用しているか？ <!-- What alternative methods could have been used to introduce a control group? --> コントロールグループを導入するために使用できる代替手法は何か？</li>
</ol>
<!-- 3. Fama et al. (1969, p. 9) state “the most important empirical results of this study are summarized in Tables 2 and 3 and Figures 2 and 3.”  --><ol start="2" type="1">
<li>Fama et al.&nbsp;(1969, p.&nbsp;9)は「この研究の最も重要な実証結果は、表2と表3、図2と図3にまとめられている」と述べている。 <!-- What does Table 3 of FFJR tell us? (Hint: Read p. 11.) Do you find the presentation of Table 3 to be effective? --> FFJRの表3は何を示しているか？（ヒント：p.11を見なさい）表3の提示は効果的だと思うか？</li>
</ol>
<!-- 4. Consider Table 2 of FFJR.  --><ol start="3" type="1">
<li>FFJRの表2を考えてみよう。 <!-- Is it more or less important than Table 3?  --> それは表3よりも重要ですか？ <!-- What is the relationship between Table 2 and Figures 2 and 3? --> 表2と図2、図3の関係は何ですか？</li>
</ol>
<!-- 5. What statistical tests are used to test the hypotheses of the paper? --><ol start="4" type="1">
<li>論文の仮説を検証するために使用される統計的検定は何か？</li>
</ol>
<!-- 10.4 Replication of FFJR --></section></section><section id="ffjrの再現" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="ffjrの再現">
<span class="header-section-number">3.5</span> FFJRの再現</h2>
<!-- We will now conduct a rough replication of FFJR.5 -->
<p>ここでは、FFJRのおおまかな再現を行う。[^5]</p>
<!-- All the data we will use come from the crsp schema.  -->
<p>使用するすべてのデータは、<code>crsp</code>スキーマから取得する。 <!-- The new table here is dsedist, which contains information on distributions, including dividends and stock splits. --> ここで新しいテーブルは<code>dsedist</code>であり、配当や株式分割を含む分配に関する情報が含まれている。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">PostgreSQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">parquet</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">RPostgres</span><span class="fu">::</span><span class="fu"><a href="https://rpostgres.r-dbi.org/reference/Postgres.html">Postgres</a></span><span class="op">(</span><span class="op">)</span>, bigint <span class="op">=</span> <span class="st">"integer"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">msf</span> <span class="op">&lt;-</span> <span class="fu">tbl</span><span class="op">(</span><span class="va">db</span>, <span class="fu">Id</span><span class="op">(</span>schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"msf"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msi</span> <span class="op">&lt;-</span> <span class="fu">tbl</span><span class="op">(</span><span class="va">db</span>, <span class="fu">Id</span><span class="op">(</span>schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"msi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocknames</span> <span class="op">&lt;-</span> <span class="fu">tbl</span><span class="op">(</span><span class="va">db</span>, <span class="fu">Id</span><span class="op">(</span>schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"stocknames"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dsedist</span> <span class="op">&lt;-</span> <span class="fu">tbl</span><span class="op">(</span><span class="va">db</span>, <span class="fu">Id</span><span class="op">(</span>schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"dsedist"</span><span class="op">)</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html">duckdb</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">msf</span> <span class="op">&lt;-</span> <span class="fu">load_parquet</span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"msf"</span><span class="op">)</span></span>
<span><span class="va">msi</span> <span class="op">&lt;-</span> <span class="fu">load_parquet</span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"msi"</span><span class="op">)</span></span>
<span><span class="va">stocknames</span> <span class="op">&lt;-</span> <span class="fu">load_parquet</span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"stocknames"</span><span class="op">)</span></span>
<span><span class="va">dsedist</span> <span class="op">&lt;-</span> <span class="fu">load_parquet</span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"dsedist"</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<!-- Fama et al. (1969, p. 3) “define a ‘stock split’ as an exchange of shares in which at least five shares are distributed for every four formerly outstanding.  -->
<p>Fama et al.&nbsp;(1969, p.3)は、「株式分割」を、少なくとも4株が以前に発行された株式に対して5株が配布される取引と定義している。 <!-- Thus this definition of splits includes all stock dividends of 25 per cent or greater.” --> したがって、この分割の定義には、25％以上の株式配当が含まれる」。</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">splits</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dsedist</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">between</span><span class="op">(</span><span class="va">exdt</span>, <span class="st">"1927-01-01"</span>, <span class="st">"1959-12-31"</span><span class="op">)</span>,</span>
<span>         <span class="va">distcd</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5523L</span>, <span class="fl">5533L</span><span class="op">)</span>,</span>
<span>         <span class="va">facshr</span> <span class="op">&gt;=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">permno</span>, <span class="va">exdt</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>facshr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">facshr</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>split <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Fama et al. (1969, p. 3) continue: “Since the data cover only common stocks listed on the New York Stock Exchange, our rules require that to qualify for inclusion in the tests a split security must be listed on the Exchange for at least twelve months before and twelve months after the split.  -->
<p>Fama et al.&nbsp;(1969, p.3)は続けて、「このデータはニューヨーク証券取引所に上場されている普通株式のみをカバーしているため、テストに含めるためのルールとして、分割証券は分割の前後12か月間、少なくとも12か月間取引所に上場されている必要がある」と述べている。 <!-- From January, 1927, through December, 1959, 940 splits meeting these criteria occurred on the New York Stock Exchange.”  --> 1927年1月から1959年12月まで、ニューヨーク証券取引所でこれらの基準を満たす940回の分割が発生した。」 <!-- NYSE-listed stocks have exchcd == 1 and ordinary common shares are those for which the first character of shrcd is 1.  --> NYSEに上場している株式は<code>exchcd == 1</code>となり、普通株式は<code>shrcd</code>の最初の文字が1となっているものとする。 <!-- Data on exchcd and shrcd on various dates is found on crsp.stocknames.  --> さまざまな日付の<code>exchcd</code>と<code>shrcd</code>のデータは<code>crsp.stocknames</code>にある。 <!-- The following code creates a table with the permno values and date ranges for the securities meeting these criteria. --> 以下のコードは、これらの基準を満たす証券の<code>permno</code>値と日付範囲を持つテーブルを作成する。</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyse_stocks</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">stocknames</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">exchcd</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>         <span class="fu">str_sub</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">shrcd</span><span class="op">)</span>, <span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">namedt</span>, <span class="va">nameenddt</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We can then use this table to focus splits on these securities. -->
<p>このテーブルを使用して、これらの証券に焦点を当てて分割を行うことができる。</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyse_splits_raw</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">splits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">nyse_stocks</span>,</span>
<span>             <span class="fu">join_by</span><span class="op">(</span><span class="va">permno</span>, <span class="fu">between</span><span class="op">(</span><span class="va">exdt</span>, <span class="va">namedt</span>, <span class="va">nameenddt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We will need to combine these data with data on returns from crsp.msf.  -->
<p>これらのデータを<code>crsp.msf</code>からのリターンデータと組み合わせる必要がある。 <!-- The table crsp.msf contains monthly data indexed by permno and date, where date is the last trading day of the month.  --> テーブル<code>crsp.msf</code>には、<code>permno</code>と<code>date</code>でインデックス付けされた月次データが含まれており、<code>date</code>は月の最終取引日である。 <!-- The splits in nyse_splits_raw will generally not occur on dates found on crsp.msf, so we need to create a “month” variable so that we can line up observations on crsp.msf and nyse_splits_raw. --> <code>nyse_splits_raw</code>の分割は一般的に<code>crsp.msf</code>で見つかる日付には発生しないため、<code>crsp.msf</code>と<code>nyse_splits_raw</code>の観測値を整列させるために「月」変数を作成する必要がある。</p>
<!-- To this end we create a table month_indexes that includes the “index” of the month, which will also be used in doing the arithmetic to go backwards and forwards in months. -->
<p>このために、月の「インデックス」を含む<code>month_indexes</code>というテーブルを作成する。これは、月の前後に移動するための算術を行う際にも使用される。 <!-- In performing this arithmetic, we use window functions, which are discussed in the documentation for dplyr and in the “Databases” chapter of R for Data Science.6  --> この計算を行う際に<code>window</code>関数を使用する。 これについては、<code>dplyr</code>のドキュメントやR for Data Scienceの「データベース」章で説明されている。<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> <!-- Here the “index” of a month refers to its placement in the sequence of months found on crsp.msf and crsp.msi.7 --> ここでの月の「インデックス」とは、<code>crsp.msf</code>と<code>crsp.msi</code>にある月のシーケンスの配置を指す。<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">month_indexes</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">msi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu">floor_date</span><span class="op">(</span><span class="va">date</span>, <span class="st">'month'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">window_order</span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>month_index <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, <span class="va">month</span>, <span class="va">month_index</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">collect</span><span class="op">(</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We actually used window functions in Chapter 2 when we used fill() to complete data for calculating market-to-book ratios.  -->
<p>実際には、市場価格純資産倍率を計算するためのデータを補完するために<code>fill()</code>を使用したときに、<code><a href="https://rdrr.io/r/stats/window.html">window()</a></code>関数を使用した。 <!-- It turns out that the window-function functionality made available via the `dbplyr` package and PostgreSQL (using `window_order()`) are more powerful in this case than those available via the base dplyr package and tibble data frames (using `arrange()`), as the `dbplyr` version allows us to specify a `window_frame()` over which window functions are applied, as we will see below. --> この場合、<code>dbplyr</code>パッケージとPostgreSQL（<code>window_order()</code>を使用）を介して提供される<code>window</code>関数の機能は、基本的なdplyrパッケージとtibbleデータフレーム（<code>arrange()</code>を使用）を介して提供されるものよりも強力であることがわかった。<code>dbplyr</code>バージョンでは、適用される<code>window_frame()</code>を指定することができるため、以下で見るように、これを利用する。</p>
<!-- We next bring our splits data (nyse_splits_raw) into R and merge it with month_indexes. -->
<p>次に、分割データ（<code>nyse_splits_raw</code>）をRに取り込み、<code>month_indexes</code>とマージする。</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyse_splits</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">nyse_splits_raw</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu">floor_date</span><span class="op">(</span><span class="va">exdt</span>, <span class="st">'month'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">collect</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">month_indexes</span>, by <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>ex_month_index <span class="op">=</span> <span class="va">month_index</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">namedt</span>, <span class="op">-</span><span class="va">nameenddt</span>, <span class="op">-</span><span class="va">date</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We construct nyse_msf, which is essentially crsp.msf restricted to NYSE stocks and months with non-missing returns, and with the added variable month_index. -->
<p>NYSE株と欠損のないリターンを持つ月に制限された<code>crsp.msf</code>である<code>nyse_msf</code>を構築する。さらに、<code>month_index</code>という変数を追加する。</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyse_msf</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">msf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">ret</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">nyse_stocks</span>,</span>
<span>             <span class="fu">join_by</span><span class="op">(</span><span class="va">permno</span>, <span class="fu">between</span><span class="op">(</span><span class="va">date</span>, <span class="va">namedt</span>, <span class="va">nameenddt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">collect</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">month_indexes</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">month_index</span>, <span class="va">date</span>, <span class="va">ret</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- The following code merges data on splits from nyse_splits with data on returns from nyse_msf.  -->
<p>以下のコードは、<code>nyse_splits</code>からの分割データと<code>nyse_msf</code>からのリターンデータをマージする。 <!-- We create a variable (month_rel_ex) that measures the number of months between the split and the return. --> 分割とリターンの間の月数を測定する変数（<code>month_rel_ex</code>）を作成する。</p>
<!-- Because we may have multiple splits for a given permno in nyse_splits (each with a different exdt) and each will be joined with multiple return months in nyse_msf, we will have a many-to-many relationship between rows in nyse_splits and rows in nyse_msf.  -->
<p><code>nyse_splits</code>の特定の<code>permno</code>に複数の分割（それぞれ異なる<code>exdt</code>）がある可能性があるため、<code>nyse_splits</code>の行と<code>nyse_msf</code>の行との間には多対多の関係がある。 <!-- To suppress a warning that dplyr issues in such cases, we indicate that we anticipate such matches by specifying relationship = "many-to-many" as an argument to left_join(). --> このような場合にdplyrが発行する警告を抑制するために、<code>left_join()</code>の引数として<code>relationship = "many-to-many"</code>を指定して、このようなマッチを予想していることを示す。</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">split_return_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">nyse_splits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">nyse_msf</span>, by <span class="op">=</span> <span class="st">"permno"</span>, relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>month_rel_ex <span class="op">=</span> <span class="va">month_index</span> <span class="op">-</span> <span class="va">ex_month_index</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">exdt</span>, <span class="va">month_rel_ex</span>, <span class="va">date</span>, <span class="va">ret</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- However, we want to ensure that we have just one row for each (permno, exdt, month_rel_ex) combination: -->
<p>ただし、各（<code>permno</code>、<code>exdt</code>、<code>month_rel_ex</code>）の組み合わせに1行だけあることを確認したい。</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">split_return_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">permno</span>, <span class="va">exdt</span>, <span class="va">month_rel_ex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span>n_rows <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Fama et al. (1969, p. 3) “decided, arbitrarily, that in order to get reliable estimates of the parameters that will be used in the analysis, it is necessary to have at least twenty-four successive months of price-dividend data around the split date.”  -->
<p>Fama et al.&nbsp;(1969, p.3)は、「分析に使用されるパラメータの信頼性の高い推定値を得るためには、分割日の周囲に少なくとも24か月連続して価格配当データが必要である」と任意に決定した。 <!-- Note that Fama et al. (1969) actually look at 12 months before and 12 months after the split, so including the month of the split, we have 25 months.  --> 実際にFama et al.&nbsp;(1969)は分割の前後12か月を見ているため、分割の月を含めると25か月となる。 <!-- The table split_sample imposes this restriction and, by doing a semi_join() of this with split_return_data, we create split_returns, which contains the data from crsp.msf for our sample of splits. --> <code>split_sample</code>テーブルはこの制限を課し、<code>split_return_data</code>との<code>semi_join()</code>を行うことで、サンプルの分割データを含む<code>split_returns</code>を作成する。</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">split_sample</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">split_return_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">between</span><span class="op">(</span><span class="va">month_rel_ex</span>, <span class="op">-</span><span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">permno</span>, <span class="va">exdt</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>n_obs <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">n_obs</span> <span class="op">==</span> <span class="fl">25L</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">exdt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_returns</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">split_return_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">semi_join</span><span class="op">(</span><span class="va">split_sample</span>, by <span class="op">=</span> <span class="st">"permno"</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- The sample of Fama et al. (1969, p. 4) comprises 940 splits for 622 securities.  -->
<p>Fama et al.&nbsp;(1969, p.4)のサンプルは、622の証券に対する940の分割から構成されている。 <!-- The output from the code below suggests that our sample is slightly larger, perhaps due to changes in the underlying data since 1966. --> 以下のコードの出力から、私たちのサンプルがわずかに大きいことが示唆されているが、これは1966年以降の基礎データの変更によるものかもしれない。</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">split_sample</span> <span class="op">|&gt;</span> <span class="fu">distinct</span><span class="op">(</span><span class="va">permno</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">count</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_sample</span> <span class="op">|&gt;</span> <span class="fu">count</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">pull</span><span class="op">(</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We follow the basic approach of FFJR in estimating excess returns. -->
<p>我々は、FFJRの超過リターンを推定する基本的なアプローチに従う。 <!-- FFJR estimate a market model by regressing the log of gross returns of each stock on the log of gross returns of a market index and taking the residual. --> FFJRは、各株式の総リターンの対数を市場指数の対数の総リターンに回帰させ、残差を取ることで市場モデルを推定している。</p>
<!-- The market index used in Fama et al. (1969, p.4) is Fisher’s Combination Investment Performance Index, which is made available as Table A1 in Fisher (1966). -->
<p>Fama et al.&nbsp;(1969, p.4)で使用されている市場指数は、Fisher (1966)の表A1として提供されている，Fisherの組み合わせ投資パフォーマンス指数(combination investment performance index)である。 <!-- To use this table, which is not available in a machine-readable form, we would have to type in the hundreds of numbers contained therein. --> この表を使用するためには、機械可読形式で利用できないため、そこに含まれる数百の数値を入力する必要がある。 <!-- Instead of doing that, we will use one of the standard indexes provided by CRSP in crsp.msi. --> その代わりに、<code>crsp.msi</code>で提供されているCRSPの標準指数の1つを使用する。 <!-- There are two widely used indexes on crsp.msi: vwretd provides the value-weighted return including distributions and ewretd provides the equal-weighted return including distributions. --> <code>crsp.msi</code>には、2つの広く使用されている指数がある：<code>vwretd</code>は配当を含む時価総額加重リターンを提供し、<code>ewretd</code>は配当を含む等加重リターンを提供する。 <!-- A value-weighted index weights each security in the portfolio based on its market value at the time of portfolio formation, while an equal-weighted index puts equal weight on each security in the portfolio regardless of its market value. --> 時価総額加重指数は、ポートフォリオ形成時の各証券の時価総額に基づいてポートフォリオ内の各証券に重みを付ける一方、等加重指数は各証券に等しい重みを付ける。 <!-- For our base analysis, we will focus on vwretd. --> 基本分析では、<code>vwretd</code>に焦点を当てる。</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">index_returns</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">msi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, <span class="va">vwretd</span>, <span class="va">ewretd</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">collect</span><span class="op">(</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Fama et al. (1969, pp. 4–5) express concern about non-zero excess returns causing “specification error” and exclude “fifteen months before the split for all securities and fifteen months after the split for splits followed by dividend decreases.” -->
<p>Fama et al.&nbsp;(1969, pp.4-5)は，「特定化誤差」(specification error)を引き起こす非ゼロの超過リターンについて懸念を示し，「すべての証券について分割前の15か月と，配当減少に続く分割後の15か月を除外する」と述べている。 <!-- We partially implement this by excluding fifteen months before the split for all securities, but not excluding any months after the split, as this requires data on dividends that would not have been available at the time of the split - which we do not compile until later (see below) - and thus induces additional look-ahead issues. --> すべての証券について、分割前の15カ月は除外するが、分割後の月は除外しないことで、これを部分的に実施している、 というのも、分割時には入手できなかったであろう配当に関するデータが必要となり、その結果、さらなる先行問題(look-ahead issue)が生じるからである。</p>
<!-- Note that because a (permno, date) combination may appear for more than one split, and be within fifteen months before the split for one split, and not so for another split, we need to aggregate data across such observations. -->
<p>(<code>permno</code>, <code>date</code>)の組み合わせは複数の分割に対して現れる可能性があるため、ある分割の15か月前にあるが、別の分割にはそうではない場合があるため、このような観測を横断してデータを集約する必要があることに注意する。 <!-- The following code sets exclude to true if the (permno, date) combination is within fifteen months before any split for that stock. --> 以下のコードは、その株式に対して15か月以内のいずれかの分割がある場合、(<code>permno</code>, <code>date</code>)の組み合わせが真である場合、<code>exclude</code>を<code>true</code>に設定する。</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">omit_returns</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">split_returns</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># month_rel_exが-15から0の間の場合はtrue</span></span>
<span>    exclude <span class="op">=</span> <span class="fu">between</span><span class="op">(</span><span class="va">month_rel_ex</span>, <span class="op">-</span><span class="fl">15</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">permno</span>, <span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">exclude</span><span class="op">)</span>, <span class="co"># excludeにTrueが1つでもあればTrue</span></span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span> <span class="co"># グループ化を解除</span></span>
<span>     <span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- The following code adds exclude to the data from split_returns.  -->
<p>以下のコードは、<code>split_returns</code>からのデータに<code>exclude</code>を追加する。 <!-- Note that we need to select distinct values for return data from split_returns, as a (permno, date) combination may appear more than once, but with different values of month_rel_ex due to it relating to more than one split.  --> <code>split_returns</code>からのリターンデータについては、(<code>permno</code>, <code>date</code>)の組み合わせが複数回現れる可能性があるため、<code>month_rel_ex</code>の値が異なることがあるため、一意の値を選択する必要があることに注意する。 <!-- Note also that we do not simply drop rows from the data set where exclude is TRUE, as we want to calculate abnormal returns for these months.  --> また、<code>exclude</code>が<code>TRUE</code>のデータセットから行を単純に削除しないことに注意する。これらの月の異常リターンを計算したいからである。 <!-- Instead, we merely exclude these observations from the regression analysis by specifying subset = !exclude. --> 代わりに、<code>subset = !exclude</code>を指定することで、これらの観測を回帰分析から除外するだけである。</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">split_returns_reg</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">split_returns</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">omit_returns</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"permno"</span>, <span class="st">"date"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">date</span>, <span class="va">ret</span>, <span class="va">exclude</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- The next step is to estimate regressions by permno.  -->
<p>次のステップは、<code>permno</code>ごとに回帰を推定することである。 <!-- Like FFJR, we estimate a market model by regressing the log of gross returns of each stock on the log of gross returns of a market index.  --> FFJRと同様に、各株式の総リターンの対数を市場指数の総リターンの対数に回帰させることで、市場モデルを推定する。 <!-- In the code below, we make extensive use of ideas from the “many models” chapter of the first edition of R for Data Science and you may find it helpful to read that chapter.8 --> 以下のコードでは、R for Data Scienceの第1版の「多数のモデル」章のアイデアを広く活用しており、その章を読むと役立つかもしれません。<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<!-- Because we want to fit one model for each permno, we facilitate this by using nest() to put all the data for each value of permno (other than the value of permno) into a single column. -->
<p>各<code>permno</code>の値について1つのモデルを適合させたいため、<code>permno</code>の値以外のすべてのデータを1つの列にまとめるために<code>nest()</code>を使用する。 <!-- We can then use map() from the purrr library to create a new column fit that contains a fitted linear (OLS) model for each permno value. --> その後、purrrライブラリの<code>map()</code>を使用して、各<code>permno</code>値に対して適合した線形（OLS）モデルを含む新しい列<code>fit</code>を作成することができる。 <!-- If we apply predict() to the model, we will get fitted values only for those observations used to estimate the model, which will mean we will not have predicted values for months within fifteen months before the split. --> モデルに<code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>を適用すると、モデルを推定するために使用された観測値のみに対して適合値が得られるため、分割の15か月前の月に対して予測値が得られないことになる。 <!-- Instead, we need to supply data for all observations as the second argument (newdata) of the predict function. --> 代わりに、<code>predict</code>関数の第2引数（<code>newdata</code>）としてすべての観測データを提供する必要がある。 <!-- To do this, we use map2() from the purrr library and store the result in the variable predicted. --> これを行うために、purrrライブラリの<code>map2()</code>を使用し、結果を変数<code>predicted</code>に格納する。</p>
<!-- Note that predicted will be a list-column in which each element is a vector of predicted values using the market model for the applicable permno. -->
<p><code>predicted</code>はリスト列であり、各要素は該当する<code>permno</code>に対して市場モデルを使用して予測された値のベクトルである。 <!-- We can use unnest() from the tidyr package to “expand” the data frame so that each row relates to a given (permno, date) pair. --> <code>tidyr</code>パッケージの<code>unnest()</code>を使用して、各行が特定の（<code>permno</code>、<code>date</code>）のペアに関連するようにデータフレームを「展開」することができる。 <!-- Finally, we calculate excess returns by subtracting predicted from the actual value of lpr and store the result in the column named resid. --> 最後に、予測値を<code>lpr</code>の実際の値から引いて超過リターンを計算し、その結果を<code>resid</code>という列に格納する。</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">abnormal_returns</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">split_returns_reg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">index_returns</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>lpr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ret</span><span class="op">)</span>,</span>
<span>         lm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">vwretd</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">date</span>, <span class="va">lpr</span>, <span class="va">lm</span>, <span class="va">exclude</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">nest</span><span class="op">(</span>data <span class="op">=</span> <span class="op">!</span><span class="va">permno</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>fit <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">lpr</span> <span class="op">~</span> <span class="va">lm</span>, data <span class="op">=</span> <span class="va">x</span>, subset <span class="op">=</span> <span class="op">!</span><span class="va">exclude</span>,</span>
<span>                              na.action <span class="op">=</span> <span class="st">"na.exclude"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>predicted <span class="op">=</span> <span class="fu">map2</span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, \<span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">x</span>, newdata <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">predicted</span>, <span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>resid <span class="op">=</span> <span class="va">lpr</span> <span class="op">-</span> <span class="va">predicted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">date</span>, <span class="va">resid</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- To facilitate joining abnormal_returns with nyse_splits, we create a version of nyse_splits with start and end columns that indicate the month_index of the first and last months that we want abnormal returns for (i.e., within 30 months of the split). -->
<p><code>abnormal_returns</code>を<code>nyse_splits</code>と結合するために、<code>nyse_splits</code>のバージョンを作成し、<code>start</code>と<code>end</code>列を作成する。これらは、超過リターンを取得したい最初の月と最後の月の<code>month_index</code>を示している（つまり、分割の30か月以内）。</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyse_splits_join</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">nyse_splits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>start <span class="op">=</span> <span class="va">ex_month_index</span> <span class="op">-</span> <span class="fl">30</span>,</span>
<span>         end <span class="op">=</span> <span class="va">ex_month_index</span> <span class="op">+</span> <span class="fl">30</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We can combine abnormal_returns with nyse_splits, but before doing so, we need to pull in month_index for each date from month_indexes. -->
<p><code>abnormal_returns</code>を<code>nyse_splits</code>と組み合わせることができるが、その前に<code>month_indexes</code>から各日付の<code>month_index</code>を取得する必要がある。 <!-- We join abnormal_returns with nyse_splits using permno and month_index between start and end. --> <code>abnormal_returns</code>を<code>nyse_splits</code>と結合する際には、<code>permno</code>と<code>month_index</code>を<code>start</code>と<code>end</code>の間で使用する。</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">table2_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">abnormal_returns</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">month_indexes</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">nyse_splits_join</span>,</span>
<span>             <span class="fu">join_by</span><span class="op">(</span><span class="va">permno</span>, <span class="fu">between</span><span class="op">(</span><span class="va">month_index</span>, <span class="va">start</span>, <span class="va">end</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>month_gap <span class="op">=</span> <span class="va">month_index</span> <span class="op">-</span> <span class="va">ex_month_index</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">exdt</span>, <span class="va">month_gap</span>, <span class="va">resid</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Before proceeding, we check that we have just one row for each split (permno and exdt) and relative month (month_gap).[^9] -->
<p>処理の前に，各分割（<code>permno</code>と<code>exdt</code>）と相対月（<code>month_gap</code>）について1行だけあることを確認する。<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">table2_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">permno</span>, <span class="va">exdt</span>, <span class="va">month_gap</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span>n_rows <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We now have the data we need to produce Figure 10.1, our analogue of Figure 2b from Fama et al. (1969, p. 13). -->
<p>これで、Fama et al.&nbsp;(1969, p.13)の図2bのアナログである図10.1を作成するために必要なデータが揃った。</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">table2_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">month_gap</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>all_u <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">month_gap</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>all_U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">all_u</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">month_gap</span>, y <span class="op">=</span> <span class="va">all_U</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- 10.4.1 Data on dividends -->
<section id="配当データ" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="配当データ">
<span class="header-section-number">3.5.1</span> 配当データ</h3>
<!-- Most columns of Table 2 of FFJR and all plots in Figure 3 of FFJR require data on dividends.  -->
<p>FFJRの表2のほとんどの列とFFJRの図3のすべてのプロットには、配当データが必要である。 <!-- We collect data on dividends from dsedist.10  --> 配当データは<code>dsedist</code>から収集する。<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> <!-- Ordinary dividends are distinguished from other distributions (e.g., liquidating dividends or exchanges and reorganizations) by the first digit of distcd, which is 1 for ordinary dividends. --> 普通配当は、<code>distcd</code>の1桁目が普通配当の1であることで、他の分配（清算配当や交換・再編成など）と区別される。</p>
<!-- It turns out that there can be more than one dividend paid in a given month for a given security, so we aggregate dividends by (permno, month). -->
<p>特定の証券について特定の月に複数の配当が支払われることがあるため、（<code>permno</code>、<code>month</code>）で配当を集計する。</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">div_months</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dsedist</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">str_sub</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">distcd</span><span class="op">)</span>, <span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu">floor_date</span><span class="op">(</span><span class="va">exdt</span>, <span class="st">'month'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>divamt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">divamt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- For each month, FFJR define “the dividend change ratio as total dividends (per equivalent unsplit share) paid in the twelve months after the split, divided by total dividends paid during the twelve months before the split” Fama et al. (1969, p.8).  -->
<p>各月に対して，FFJRは「分割後12ヶ月に支払われた(分割前の株式1株当たり)配当合計を分割前12ヶ月に支払われた配当合計で割ったもの」を配当変化率と定義している。(Fama et al., 1969, p.8)。</p>
<!-- So, for each month $t$,  we want to sum up dividends from month $t-11$ to month $t$ and also dividends for months $t+1$  through $t+12$ .  -->
<p>したがって、各月<span class="math inline">t</span>について、月<span class="math inline">t-11</span>から月<span class="math inline">t</span>までの配当と、月<span class="math inline">t+1</span>から月<span class="math inline">t+12</span>までの配当を合計したい。</p>
<!-- Care is needed to calculate dividends “per equivalent unsplit share” as a firm paying 80 cents per share each quarter prior to a 2-for-1 split should be considered to have increased its dividends if it paid 45 cents per share (i.e., 90 cents per original share) in each quarter after the split.  -->
<p>「分割前に四半期ごとに1株当たり80セントを支払っていた企業が、分割後に1株当たり45セント（つまり、元の株式1株当たり90セント）を支払った場合、配当を増やしたと見なすべきである」ということを考慮して、「分割前の株式1株当たり」で配当を計算するために注意が必要である。 <!-- The variable cfacshr from msf allows us to make the necessary adjustment.11 --> <code>msf</code>の<code>cfacshr</code>変数を使用することで、必要な調整を行うことができる。<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<!-- If no dividends are paid on a stock in a given month, we set divamt to zero; this allows us to distinguish months where a stock is not an NYSE stock on crsp.msf (missing from this table) from ones where it is, but pays no dividend that month (i.e., zero divamt).12 -->
<p>所与とした月に株式に配当が支払われない場合、<code>divamt</code>をゼロに設定する。これにより、株式が<code>crsp.msf</code>においてNYSE株ではない月（この表にはない）と、NYSE株であるがその月に配当を支払わない月（つまり、<code>divamt</code>がゼロ）を区別することができる。<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyse_divs_raw</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">msf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">nyse_stocks</span>, by <span class="op">=</span> <span class="st">"permno"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">between</span><span class="op">(</span><span class="va">date</span>, <span class="va">namedt</span>, <span class="va">nameenddt</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu">floor_date</span><span class="op">(</span><span class="va">date</span>, <span class="st">'month'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">date</span>, <span class="va">month</span>, <span class="va">cfacshr</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">div_months</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"permno"</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>divamt <span class="op">=</span> <span class="fu">coalesce</span><span class="op">(</span><span class="va">divamt</span> <span class="op">/</span> <span class="va">cfacshr</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, <span class="va">divamt</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- The following code aggregates the variables needed to calculate the dividend change ratio mentioned above: dividends paid in the twelve months after the split and dividends paid during the twelve months before the split. -->
<p>次のコードは、上記で言及した配当変化率を計算するために必要な変数を集計する。すなわち、分割後12ヶ月に支払われた配当と分割前12ヶ月に支払われた配当である。</p>
<!-- In this case, we specify `group_by(permno)` as we want windows to be applied on a by - PERMNO basis (i.e., when calculating trailing and forward dividends, we are only interested in dividends related to a single PERMNO) and then `window_order(month)`, as we want to arrange the data within each window by month so that “go back 11 months” is meaningfully defined. In the next step, we specify `window_frame(from = -11, to = 0)` to indicate that in the subsequent calculation, we want to include values from $t-11$ to $t$ in the window.13 -->
<p>この場合，<code>PERMNO</code>ごとにウィンドウを適用したいため，<code>group_by(permno)</code>を指定している。そして，各ウィンドウ内のデータを月で並べ替えるために<code>window_order(month)</code>を指定している。次のステップでは、<code>window_frame(from = -11, to = 0)</code>を指定して、以降の計算でウィンドウに <span class="math inline">t-11</span> から <span class="math inline">t</span> までの値を含めることを示している。 <!-- This drives the values considered in the subsequent `mutate()` step, which calculates `div_trailing` and `mths_trailing`. --> これにより、次の<code>mutate()</code>ステップで計算される<code>div_trailing</code>と<code>mths_trailing</code>が考慮される。 <!-- Note that `na.rm = TRUE` is always the case for SQL (which this code is ultimately translated into) and that `n()` counts the numbers of rows included in the window. --> <code>na.rm = TRUE</code>は常にSQL（このコードが最終的に変換されるもの）の場合であり、<code>n()</code>はウィンドウに含まれる行数を数える。</p>
<!-- We then respecify the window using `window_frame(from = 1, to = 12)` so that we can calculate `div_forward` and `mths_forward`. -->
<p>次に、<code>div_forward</code>と<code>mths_forward</code>を計算するために、ウィンドウを<code>window_frame(from = 1, to = 12)</code>に再指定する。</p>
<!-- Finally, to exclude cases where, say, a stock has listed within the last twelve months or delists in the subsequent twelve months and thereby perhaps makes the calculation of the dividend change ratio less meaningful, we use filter(`mths_trailing == 12`, `mths_forward == 12`). -->
<p>最後に、例えば、株式が過去12か月以内に上場したり、次の12か月で上場廃止されたりして、配当変化率の計算があまり意味をなさない場合を除外するために、<code>filter(mths_trailing == 12, mths_forward == 12)</code>を使用する。 <!-- Finally, we ungroup to remove the `group_by(permno)` grouping that we no longer need, select the variables of interest, and then collect the data. --> 不要になったグループ化<code>group_by(permno)</code>を除去するために<code>ungroup()</code>を使い，興味のある変数を選択し、データを収集している。</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyse_divs</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">nyse_divs_raw</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">permno</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">window_order</span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">window_frame</span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">11</span>, to <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>div_trailing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">divamt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         mths_trailing <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">window_frame</span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>div_forward <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">divamt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         mths_forward <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mths_trailing</span> <span class="op">==</span> <span class="fl">12</span>, <span class="va">mths_forward</span> <span class="op">==</span> <span class="fl">12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, <span class="va">div_trailing</span>, <span class="va">div_forward</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">collect</span><span class="op">(</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Now that we have data on div_trailing and div_forward for every (permno, month) combination on NYSE, we can use these data to calculate the dividend change ratio (div_ratio) for each of the split months on nyse_splits. -->
<p>NYSEのすべての（<code>permno</code>、<code>month</code>）の組み合わせについて<code>div_trailing</code>と<code>div_forward</code>のデータがあるので、これらのデータを使用して、nyse_splitsの各分割月の配当変化率（<code>div_ratio</code>）を計算することができる。</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">split_firm_dividends</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">nyse_splits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">nyse_divs</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"permno"</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>div_ratio <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">div_trailing</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>                             <span class="va">div_forward</span> <span class="op">/</span> <span class="va">div_trailing</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">div_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, <span class="va">exdt</span>, <span class="va">div_ratio</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Fama et al. (1969, p. 8) measure dividend changes "relative to the average dividends paid by all securities on the New York Stock Exchange during the relevant time periods. … Dividend ‘increases’ are then defined as cases where the dividend change ratio of the split stock is greater than the ratio for the Exchange as a whole."  -->
<p>Fama et al.&nbsp;(1969, p.8)は、「関連する期間中にNYSEで全証券が支払った配当平均に対する配当変化を測定する。…配当の「増加」は、分割株の配当変化率が取引所全体の比率よりも大きい場合と定義される。」 <!-- We calculate the “market” dividend change ratio (mkt_div_ratio) by averaging the div_trailing and div_forward values for each month across all stocks. --> 各月の全株式にわたる<code>div_trailing</code>と<code>div_forward</code>の値を平均することで、「市場」の配当変化率（<code>mkt_div_ratio</code>）を計算する。</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">div_mkt</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">nyse_divs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>div_trailing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">div_trailing</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            div_forward <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">div_forward</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mkt_div_ratio <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">div_trailing</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>                                 <span class="va">div_forward</span> <span class="op">/</span> <span class="va">div_trailing</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We can then combine data on split- and market-level dividend change ratios for each month in which there is a split to calculate up_div, which is an indicator for the dividend change ratios for a stock undergoing a split being greater than that for the market in that month. -->
<p>本稿では，分割が行われる各月について，分割レベルと市場レベルの配当変化率のデータを組み合わせて，分割を受ける株式の配当変化率がその月の市場の配当変化率よりも大きいかどうかを示す指標である<code>up_div</code>を計算する。</p>
<!-- Fama et al. (1969, p. 9) do not pretend that their measure of dividend increases is perfect and merely use it as “a simple and convenient way of … classifying year-to-year dividend changes for individual securities.”14 -->
<p>Fama et al.&nbsp;(1969, p.9)は、配当増加の測定が完璧であるとは主張しておらず、「個々の証券の年間配当変化を分類するための簡単で便利な方法」として使用している。</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dividends_file</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">split_firm_dividends</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">div_mkt</span>, by <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">permno</span>, <span class="va">exdt</span>, <span class="va">div_ratio</span>, <span class="va">mkt_div_ratio</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>up_div <span class="op">=</span> <span class="va">div_ratio</span> <span class="op">&gt;=</span> <span class="va">mkt_div_ratio</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Finally, we can combine data on relative dividend change ratios with abnormal return data. -->
<p>最後に，相対的な配当変化率のデータを超過リターンデータと組み合わせることができる。</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">table2_w_divs</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">table2_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">dividends_file</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"permno"</span>, <span class="st">"exdt"</span><span class="op">)</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We can now produce Figure 10.2, our analogue of Figure 3c from Fama et al. (1969, p. 15). -->
<p>これで、Fama et al.&nbsp;(1969, p.&nbsp;15)の図3cのアナログである図10.2を作成することができる。</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">table2_w_divs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">up_div</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">month_gap</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>u <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">month_gap</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">month_gap</span>, y <span class="op">=</span> <span class="va">U</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Figure 10.3 provides our equivalent of Figure 3d from Fama et al. (1969, p. 15). -->
<p>図10.3は、Fama et al.&nbsp;(1969, p.&nbsp;15)の図3dに相当するものである。</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">table2_w_divs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">up_div</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">month_gap</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>u <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">month_gap</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">month_gap</span>, y <span class="op">=</span> <span class="va">U</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ### 10.4.2 Discussion questions and exercises -->
</section><section id="議論の問題と演習" class="level3" data-number="3.5.2"><h3 data-number="3.5.2" class="anchored" data-anchor-id="議論の問題と演習">
<span class="header-section-number">3.5.2</span> 議論の問題と演習</h3>
<!-- 1. “In the past a large fraction of stock splits have been followed closely by dividend increases - and increases greater than those experienced at the same time by other securities in the market.”  -->
<p><!-- What evidence to support this claim (if any) is provided by FFJR?  --> <!-- Do we see evidence consistent with this in the data underlying our replication above? --></p>
<!-- 2. Consider the three alternative theories below.  -->
<p><!-- Suggest tests that could distinguish which of these theories best explains observed phenomena.  --> <!-- Which theory best aligns the theory proposed by FFJR? --> <!-- How would this theory need to be modified to comport better with the theory proposed by FFJR?  --></p>
<!-- - **Theory $A`$ ** : Firms like to keep their stock price within certain bounds. When the stock price rises above a certain threshold, a firm may initiate a split, announcing it several weeks in advance of its effective date.  Firms do not use splits to signal private information about firm prospects.  -->
<!-- Pre-split stock prices may be driven by information that suggests an imminent increase in dividends. -->
<!-- - **Theory $B`$** : Firms use splits to signal private information about firm prospects. -->
<!-- A firm will announce a split several weeks in advance of its effective date. -->
<!-- Firms may also use dividend changes to signal private information about firm prospects. -->
<!-- - **Theory $B``$** : Firms use splits to signal private information about future dividend increases, which in turn signal private information about firm prospects. -->
<!-- A firm will announce a split several weeks in advance of its effective date. -->
<ol type="1">
<li>「過去には、多くの株式分割が直後に配当増加に続いてきた。そして、他の証券と比較して、より大きな増加が経験されてきた。」 この主張を支持する証拠（あれば）は、FFJRによって提供されているか？ 上記の再現データの背後にあるデータには、この主張と一致する証拠が見られるか？</li>
<li>以下の3つの代替理論を考えなさい。 観察された現象を最もよく説明するのは、これらの理論のうちどれかを区別するためのテストを提案しなさい。 FFJRが提案する理論と最も一致するのはどの理論か？ この理論をFFJRが提案する理論とよりよく一致させるためには、どのように修正する必要があるか？</li>
</ol>
<ul>
<li><p><strong>理論 <span class="math inline">A'</span></strong> : 企業は株価を一定の範囲内に保ちたいと考えている。 株価がある閾値を超えると、企業は分割を開始し、有効日の数週間前に発表するかもしれない。 企業は、企業の見通しに関する非公開情報を示すために分割を使用しない。 分割前の株価は、近々の配当増加を示唆する情報によって駆動されるかもしれない。</p></li>
<li><p><strong>理論 <span class="math inline">B'</span></strong> : 企業は、企業の見通しに関する非公開情報を示すために分割を使用する。 企業は、有効日の数週間前に分割を発表する。 企業は、企業の見通しに関する非公開情報を示すために配当変更を使用するかもしれない。</p></li>
<li><p><strong>理論 <span class="math inline">B''</span></strong> : 企業は、将来の配当増加に関する非公開情報を示すために分割を使用し、これにより企業の見通しに関する非公開情報を示す。 企業は、有効日の数週間前に分割を発表する。</p></li>
</ul>
<!-- 3. On p. 17 of Fama et al. (1969), it is argued that “our data suggest that once the information effects of associated dividends are properly considered, a split per se has no net effect on common stock returns.”  --><ol start="3" type="1">
<li>Fama et al.&nbsp;(1969)の17ページでは、「関連する配当の情報効果が適切に考慮されると、分割そのものは普通株式のリターンに対して純効果を持たない」と主張されている。 <!-- Is it clear what meaning the words “per se” have in this sentence?  --> この文中の「per se」という言葉の意味が明確ですか？ <!-- Does FFJR provide persuasive evidence in support of this claim?  --> FFJRは、この主張を支持するための説得力のある証拠を提供していますか？ <!-- Describe how you might test this claim using the richer data available today.  --> 今日利用可能なより豊富なデータを使用して、この主張をどのようにテストするかを説明してください。 <!-- What data would you use beyond that used in FFJR? --> FFJRで使用されたデータ以外のデータは何ですか？</li>
</ol>
<!-- 4. How do the figures produced above compare with their equivalents in FFJR? What might account for any differences? --><ol start="4" type="1">
<li>上記で生成された図は、FFJRのそれと比較してどのように異なるか？ どのような違いがあるか？</li>
</ol>
<!-- 5. In the analysis above we used vwretd as the market index.  --><ol start="5" type="1">
<li>上記の分析では、市場指数として<code>vwretd</code>を使用しました。 <!-- Modify the code above to instead use ewretd.  --> 上記のコードを変更して、代わりに<code>ewretd</code>を使用してください。 <!-- Do you observe any changes in the resulting figures? --> 結果の図に変化はありますか？ <!-- Which do you believe is the better market index for these plots? Why? --> これらのプロットにとってより良い市場指数は何だと思いますか？ なぜですか？</li>
</ol>
<!-- ## 10.5 Capital markets research in accounting --></section></section><section id="会計における資本市場研究" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="会計における資本市場研究">
<span class="header-section-number">3.6</span> 10.5 会計における資本市場研究</h2>
<!-- This part of the book focuses on capital markets research, which is arguably the area in which academic research has most contributed to our understanding of real-world accounting phenomena.  -->
<p>本書のこの章は、おそらく学術研究が現実の会計現象を理解するのに最も貢献している分野である資本市場研究に焦点を当てている。 <!-- One goal of this part is to provide a solid introduction to classical ideas and papers related to capital markets research in accounting. --> この章の目的の1つは、会計の資本市場研究に関連する古典的なアイデアと論文についての堅実な導入を提供することである。</p>
<!-- This chapter introduced the idea of efficient capital markets and focuses on Fama et al. (1969), one of the earliest event studies in capital markets research.  -->
<p>この章では、効率的な資本市場のアイデアを紹介し、資本市場研究の初期のイベント研究の1つであるFama et al.&nbsp;(1969)に焦点を当てた。 <!-- The next two chapters—Chapters 11 and 12—cover two seminal papers, Ball and Brown (1968) and Beaver (1968), respectively.  --> 次の2章、第11章と第12章では、それぞれBall and Brown (1968)とBeaver (1968)という2つの画期的な論文について取り上げる。 <!-- While the first three chapters of this part study papers from more than 50 years ago, we believe that they provide an excellent introduction to the foundations of research design that remain relevant to this day. --> 最初の3章は、50年以上前の論文を研究しているが、それらは今日でも有効な研究デザインの基礎を優れた導入を提供していると考えている。</p>
<!-- Chapter 13 builds on the three previous chapters in providing more depth on event studies, including coverage of how event studies have evolved since Fama et al. (1969).  -->
<p>第13章は、Fama et al.&nbsp;(1969)以来のイベント研究の進化についても含め、イベント研究についてさらに詳しく説明するために、前の3章に基づいて構築されている。 <!-- Chapter 14 examines post-earnings announcement drift, a much-studied anomaly in the pricing of accounting information in capital markets.  --> 第14章では、資本市場における会計情報の価格設定における多くの研究された異常である<strong>決算発表後の株価ドリフト</strong>(Post-Earnings Annoucement Drift: PEAD)を調査する。 <!-- Chapter 15 goes deeper into the measurement of accruals, a critical element of financial accounting, and also provides an opportunity to explore simulation analysis in more detail.  --> 第15章では、負債の計測についてさらに詳しく説明し、財務会計の重要な要素であることと、シミュレーション分析をより詳しく探求する機会を提供する。 <!-- Chapter 16 explores earnings management, which has been the focus of significant body of accounting research over several decades, and also provides an opportunity to understand issues related to measurement in research and the power of statistical tests. --> 第16章では、数十年にわたり多くの会計研究の焦点となってきた<strong>利益マネジメント</strong>(earnings management)を探求し、研究における測定に関連する問題や統計的検定の力を理解する機会を提供する。</p>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>EMHのもう1つの深い含意は、価格がある意味で「正しい」はずであるということである。<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>いくつかの場合、経営者は、分割後に自分自身で株式を購入したい場合など、分割後の株価が低いほうが有利になるかもしれない。<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>シグナリング理論については、Kreps (1990)の第17章を参照。<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Evidence that FFJR have a signalling story in mind comes from subsequent sentences in the paper.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Also see https://www.postgresql.org/docs/current/tutorial-window.html.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Note that we are operating on remote data here, so we use window_order() instead of arrange() when using window functions. In fact, window_order() offers power that is not available with local data frames. In Chapters 6 and 8, we used dbplyr implicitly when connecting to databases through the dplyr package, but window_order() is not “re-exported” by the dplyr package and thus we needed to invoke library(dbplyr) above.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>aaa08<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>aaa09<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>aaa10<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>aaa11<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>aaa12<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "コピーしました");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "コピーしました");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/so-ichi\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./chap09_import.html" class="pagination-link" aria-label="データを読み込む">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">データを読み込む</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chap11_BB1968.html" class="pagination-link" aria-label="Ball and Brown (1968)">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ball and Brown (1968)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Soichi Matsuura</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ma2ura">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/matsuura_rits">
      <i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>