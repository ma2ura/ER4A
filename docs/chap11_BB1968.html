<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4&nbsp; Ball and Brown (1968) – Empirical Research in Accounting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap12_Beaver1968.html" rel="next">
<link href="./chap10_FFJR.html" rel="prev">
<link href="./img/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c58e7bee4ee1a6584ec9d1fc0e841892.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-2e8bc3580cc84ea2920b26bb0544913d.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta name="twitter:title" content="4&nbsp; Ball and Brown (1968) – Empirical Research in Accounting">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap10_FFJR.html">資本市場研究</a></li><li class="breadcrumb-item"><a href="./chap11_BB1968.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ball and Brown (1968)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Empirical Research in Accounting</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/ma2ura/ER4A/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">序論</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap01_Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">はじめに</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap09_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">データを読み込む</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">資本市場研究</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap10_FFJR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">FFJR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap11_BB1968.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ball and Brown (1968)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap12_Beaver1968.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Beaver (1968)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap13_Event.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">イベント・スタディ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap15_accruals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">アクルーアル</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap16_em.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">利益マネジメント</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">因果推論</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap17_Natural.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">自然実験</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap18_Causal_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">因果メカニズム</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">追加的なトピック</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appA_LinearAlgebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">線形代数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appB_SQL.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">SQL入門</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appC_Computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">研究のためのコンピュータ概論</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#ball-and-brown-1968%E3%81%AE%E4%B8%BB%E8%A6%81%E7%B5%90%E6%9E%9C" id="toc-ball-and-brown-1968の主要結果" class="nav-link active" data-scroll-target="#ball-and-brown-1968%E3%81%AE%E4%B8%BB%E8%A6%81%E7%B5%90%E6%9E%9C"><span class="header-section-number">4.1</span> Ball and Brown (1968)の主要結果</a>
  <ul class="collapse">
<li><a href="#%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E8%AA%B2%E9%A1%8C" id="toc-ディスカッション課題" class="nav-link" data-scroll-target="#%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E8%AA%B2%E9%A1%8C"><span class="header-section-number">4.1.1</span> ディスカッション課題</a></li>
  </ul>
</li>
  <li>
<a href="#ball-and-brown-1968%E3%81%AE%E5%86%8D%E7%8F%BE" id="toc-ball-and-brown-1968の再現" class="nav-link" data-scroll-target="#ball-and-brown-1968%E3%81%AE%E5%86%8D%E7%8F%BE"><span class="header-section-number">4.2</span> Ball and Brown (1968)の再現</a>
  <ul class="collapse">
<li><a href="#%E7%99%BA%E8%A1%A8%E6%97%A5%E3%81%A8%E3%83%AA%E3%82%BF%E3%83%BC%E3%83%B3%E3%83%87%E3%83%BC%E3%82%BF" id="toc-発表日とリターンデータ" class="nav-link" data-scroll-target="#%E7%99%BA%E8%A1%A8%E6%97%A5%E3%81%A8%E3%83%AA%E3%82%BF%E3%83%BC%E3%83%B3%E3%83%87%E3%83%BC%E3%82%BF"><span class="header-section-number">4.2.1</span> 発表日とリターンデータ</a></li>
  <li><a href="#%E3%82%B5%E3%82%A4%E3%82%BA%E3%83%9D%E3%83%BC%E3%83%88%E3%83%95%E3%82%A9%E3%83%AA%E3%82%AA%E3%83%AA%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF" id="toc-サイズポートフォリオリターンのデータ" class="nav-link" data-scroll-target="#%E3%82%B5%E3%82%A4%E3%82%BA%E3%83%9D%E3%83%BC%E3%83%88%E3%83%95%E3%82%A9%E3%83%AA%E3%82%AA%E3%83%AA%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF"><span class="header-section-number">4.2.2</span> サイズポートフォリオリターンのデータ</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap10_FFJR.html">資本市場研究</a></li><li class="breadcrumb-item"><a href="./chap11_BB1968.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ball and Brown (1968)</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ball and Brown (1968)</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!-- In this and the following chapter, we cover the first two winners of the Seminal Contributions to Accounting Literature Award: Ball and Brown (1968) and Beaver (1968).1 --><p>本章と次章では，「the Seminal Contributions to Accounting Literature Award」の最初の2つの受賞者であるBall and Brown (1968)とBeaver (1968)について説明する。</p>
<!-- Ball and Brown (1968) won the inaugural Seminal Contribution to the Accounting Literature Award with a citation: “No other paper has been cited as often or has played so important a role in the development of accounting research during the past thirty years.” -->
<p>Ball and Brown (1968)は最初に「the Seminal Contribution to the Accounting Literature Award」を受賞し，その受賞理由は「過去30年間において，他のどの論文よりも引用されている論文はなく，会計研究の発展において重要な役割を果たしている」とされている。 <!-- However, Philip Brown (Brown, 1989) recalled in a presentation to the 1989 JAR conference that the paper was rejected by The Accounting Review with the editor indicating a willingness to “reconsider the manuscript if Ray and I wished to cut down the empirical stuff and expand the ‘bridge’ we had tried to build between our paper and the accounting literature.” (Brown, 1989, p. 205) --> しかし，Philip Brown (Brown, 1989)は1989年のJARカンファレンスでのプレゼンテーションで，この論文がThe Accounting Reviewに拒否されたことを振り返り，編集者が「Rayと私が実証的な部分を削減し，私たちが試みた論文と会計文献との間に構築しようとした『橋』を拡大することを望むなら，原稿を再検討する用意がある」と述べている。</p>
<!-- According to Kothari (2001, p. 113), “Ball and Brown (1968) and Beaver (1968) heralded empirical capital markets research as it is now known.” -->
<p>Kothari (2001, p.&nbsp;113)によると，「Ball and Brown (1968)とBeaver (1968)は，現在知られている実証的な資本市場研究の到来を告げた」としている。 <!-- Prior to that period, accounting research was a largely theoretical discipline focused on normative research, that is, research concerned with the “right” or “best” way to account for various events and transactions. --> それ以前の時期には，会計研究は主に理論的な学問であり，規範的研究に焦点を当てていた。つまり，さまざまな事象や取引について「正しい」または「最良の」会計処理方法に関心を持つ研究であった。 <!-- In addition to being normative, accounting theory was largely deductive, meaning that detailed theories were derived from general principles. --> 会計理論は規範的であるだけでなく，主に帰納的であった。つまり，一般的な原則から詳細な理論が導かれていた。</p>
<!-- Beaver (1998) identifies one approach as asking, say, “what properties should the ‘ideal’ net income have?” -->
<p>Beaver (1998)は，あるアプローチを「『理想的な』純利益にはどのような特性があるべきか？」と問うものとして特定している。 <!-- One answer to this question is that accounting income a period should reflect the change in the net present value of cash flows (plus cash distributions) to shareholders during the period. --> この質問に対する1つの回答は，ある期間の会計収益は，その期間中の株主へのキャッシュフローの現在価値の変化（およびキャッシュ配当）を反映すべきであるというものである。 <!-- But other answers existed. --> しかし，他の回答も存在した。 <!-- Accounting researchers would start with a set of desired properties and use these to derive the “best” approach to accounting for depreciation of long-lived assets, inventory, or lease assets. --> 会計研究者は，望ましい特性の集合から始め，これらを使用して長期資産の減価償却、棚卸資産、またはリース資産の会計処理の「最良」のアプローチを導き出していた。 <!-- Kothari (2001) points out that there was “little emphasis on the empirical validity” of theory. --> Kothari (2001)は，理論の「実証的な妥当性」にはほとんど重点が置かれていなかったと指摘している。</p>
<!-- Similar ideas still permeate the thinking of standard-setters, who purport to derive detailed accounting standards from their “conceptual frameworks”, which outline broad definitions of things such as assets and liabilities that standard-setters can supposedly use to derive the correct accounting approach in any given setting. -->
<p>同様の考え方は，基準設定主体の考え方に依然として浸透しており，基準設定主体は「概念フレームワーク」から詳細な会計基準を導出しようとしている。 概念フレームワークは，資産や負債などの広義の定義を概説し，基準設定主体が任意の状況で正しい会計処理方法を導き出すために使用できるとされている。</p>
<!-- However, in the period since Ball and Brown (1968), these approaches have been largely discarded in academic research. -->
<p>しかし，Ball and Brown (1968)以降の時期において，これらのアプローチは学術研究においてほとんど捨てられている。 <!-- A largely normative, theoretical emphasis has been replaced by a positive, empirical one. --> 主に規範的で理論的な重点は，実証的で経験的な重点に置き換えられている。</p>
<!-- This chapter uses Ball and Brown (2019) as a kind of reading guide to Ball and Brown (1968) before considering a replication of Ball and Brown (1968) styled on that provided by Nichols and Wahlen (2004). -->
<p>本章では，Ball and Brown (2019)をBall and Brown (1968)の読み方のガイドとして使用し，Nichols and Wahlen (2004)によるBall and Brown (1968)のレプリケーションを検討する。</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<!-- The code in this chapter uses the packages listed below. -->
<p>この章のコードは，以下のパッケージを使用する。 <!-- Because we use several packages from the Tidyverse, we save time by using library(tidyverse) to load them in one go.  --> Tidyverseからいくつかのパッケージを使用するため，<code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>を使用して一括で読み込むことで時間を節約する。 <!-- For instructions on how to set up your computer to use the code found in this book, see Section 1.2.  --> この書籍で見つかるコードを使用するためのコンピュータのセットアップ方法については，セクション1.2を参照してください。 <!-- Quarto templates for the exercises below are available on GitHub. --> 以下の演習用のQuartoテンプレートはGitHubで入手できる。</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org">DBI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iangow/farr">farr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
次のパッケージを付け加えます: 'farr'

以下のオブジェクトは 'package:base' からマスクされています:

    truncate</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dbplyr.tidyverse.org/">dbplyr</a></span><span class="op">)</span>     <span class="co"># window_order()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
次のパッケージを付け加えます: 'dbplyr'

以下のオブジェクトは 'package:dplyr' からマスクされています:

    ident, sql</code></pre>
</div>
</div>
<!-- ## Principal results of Ball and Brown (1968) -->
<section id="ball-and-brown-1968の主要結果" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="ball-and-brown-1968の主要結果">
<span class="header-section-number">4.1</span> Ball and Brown (1968)の主要結果</h2>
<!-- The first two pages of Ball and Brown (1968) address the (then) extant accounting literature. -->
<p>Ball and Brown (1968)の最初の2ページは，（当時の）既存の会計文献について述べている。 <!-- This discussion gives the impression that the (academic) conventional wisdom at that time was that accounting numbers were (more or less) meaningless (“the difference between twenty-seven tables and eight chairs”) and further research was needed to devise more meaningful accounting systems. --> この議論から，当時の（学術的な）常識は，会計数値は（おおよそ）意味がない（「27のテーブルと8つの椅子の違い」）というものであり，より意味のある会計システムを考案するためにさらなる研究が必要であるという印象を受ける。</p>
<!-- Arguably this notion informs the null hypothesis of Ball and Brown (1968). -->
<p>おそらく，この考え方は，Ball and Brown (1968)の帰無仮説に影響を与えている。 <!-- If accounting numbers are meaningless, then they should bear no relationship to economic decisions made by rational actors. --> 会計数値が意味を持たない場合，それらは合理的な行為者によって行われる経済的な意思決定とは何の関係もないはずである。 <!-- Ball and Brown (1968) seek to test this (null) hypothesis by examining the relationship between security returns and unexpected income changes. --> Ball and Brown (1968)は，株式リターンと期待外収益変化との関係を調査することで，この（帰無）仮説を検証しようとしている。 <!-- Ball and Brown (1968) argue that “recent developments in capital theory … [justify] selecting the behavior of security prices as an operational test of usefulness.” --> Ball and Brown (1968)は，「資本理論の最近の発展により，証券価格の挙動を有用性の操作的なテストとして選択することが正当化される」と主張している。</p>
<!-- The evidence provided by Ball and Brown (1968) might not convince critics of the usefulness of adding chairs and tables unless the market is a rational, efficient user of a broader set of information. -->
<p>Ball and Brown (1968)によって提供される証拠は，市場がより広範な情報を合理的かつ効率的に利用する場合にのみ，椅子とテーブルを追加することの有用性を疑問視する批評家を納得させるかもしれない。 <!-- There are accounts for the results of Ball and Brown (1968) that do not rely on such rationality and efficiency. --> Ball and Brown (1968)の結果には，そのような合理性や効率性に依存しない説明もある。 <!-- First, the market might react to “twenty-seven tables less eight chairs” because it does not know what it is doing. --> 第一に，市場は「27のテーブルから8つの椅子を引いたもの」に反応するかもしれないが，それは何をしているのかわからないためである。 <!-- Second, the market might know that “twenty-seven tables less eight chairs” is meaningless, but has no better information to rely upon. --> 第二に，市場は「27のテーブルから8つの椅子を引いたもの」が意味をなさないことを知っているかもしれないが，それ以上の情報がないために頼ることができない。 <!-- Given the arguments they seek to address, assumptions that the market is (a) efficient and (b) has access to a rich information set beyond earnings seem implicit in the use of security returns in a test of usefulness. --> 彼らが取り組もうとしている議論を考慮すると，株式リターンを使用して有用性のテストを行う際に，市場が（a）効率的であり，（b）収益以外の豊富な情報セットにアクセスできるという仮定は暗黙的に含まれているように思われる。</p>
<!-- Ball and Brown (2019, p.414) identify three main results of Ball and Brown (1968): “The most fundamental result was that accounting earnings and stock returns were correlated. -->
<p>Ball and Brown (2019, p.414)は，Ball and Brown (1968)の3つの主要な結果を次のように特定している。「最も基本的な結果は，会計収益と株価リターンが相関していたことである。 <!-- … Nevertheless, annual accounting earnings lacked timeliness. --> … それにもかかわらず，年次の会計収益にはタイムリー性が欠けていた。 <!-- … After the earnings announcement month, the API (which cumulated abnormal returns) continued to drift in the same direction.” --> … 収益発表月の後，API（異常リターンを累積したもの）は同じ方向にドリフトし続けた。」</p>
<!-- Figure 1 of Ball and Brown (1968) depicts the data provided in Table 5 and comprises all three of the principal results flagged by Ball and Brown (2019). -->
<p>Ball and Brown (1968)の図1は，表5に提供されたデータを描いており，Ball and Brown (2019)が指摘した3つの主要な結果すべてを含んでいる。</p>
<!-- The returns reported in Figure 1 of Ball and Brown (1968) are not feasible portfolios because the earnings variables used to form each portfolio at month $-12$ are not reliably available until month $0$ or later. -->
<p>Ball and Brown (1968)の図1に報告されているリターンは，月 <span class="math inline">-12</span> で各ポートフォリオを形成するために使用される収益変数が，月 <span class="math inline">0</span> 以降にならないと信頼できないため，実現可能なポートフォリオではない。 <!-- Yet one can posit the existence of a mechanism (e.g., a time machine or a magical genie) that would suffice to make the portfolios notionally feasible. --> しかし、仮にポートフォリオを理論的に実現可能にするメカニズム（例：タイムマシンや魔法の妖精）が存在すると仮定することはできる。 <!-- For example, if a genie could tell us whether earnings for the upcoming year for each firm will increase or decrease at month $-12$, we could go long on firms expecting positive news, and go short on firms expecting negative news.2  --> たとえば、もし妖精さんが各企業の翌年の収益が増加するのか減少するのかを， <span class="math inline">12</span> ヶ月前に教えてくれるとすれば、利益がプラスであるというニュースを期待できる企業の株を買い（ロング）、マイナスとなるニュースを期待する企業の株を売る（ショート）ことが可能になる。 <!-- Note that this hypothetical genie is sparing with the information she provides. --> この仮想的な妖精さんは，提供する情報を非常に限定的にしている点に注意が必要である。 <!-- For example, we might want further details on how much earnings increased or decreased, but our genie gives us just the sign of the earnings news. --> たとえば，利益がどれほど増加・減少したのかについてさらに詳細をしりたいかもしれないが，妖精さんは利益ニュースの符号だけを教えてくれる。</p>
<!-- Additionally, we have implicit constraints on the way we can use this information in forming portfolios. -->
<p>さらに，ポートフォリオを形成する際にこの情報を使用する方法には暗黙の制約がある。 <!-- We might do better to adjust the portfolio weights according to other factors, such as size or liquidity, but the portfolios implicit in Figure 1 of Ball and Brown (1968) do not do this. --> サイズや流動性などの他の要因に応じてポートフォリオのウェイトを調整する方が良いかもしれないが，Ball and Brown (1968)の図1に暗黙的に含まれるポートフォリオはこれを行っていない。 <!-- Nor do the portfolios represented in Figure 1 involve any opportunity to adjust portfolio weights during the year. --> また，図1に表されているポートフォリオには，年間を通じてポートフォリオのウェイトを調整する機会もない。</p>
<!-- In assessing the relative value of various sources of information, Ball and Brown (1968) consider three approaches to constructing portfolios, which they denote as TI, NI, and II (Ball and Brown (2019) denote II as AI and we follow this notation below). -->
<p>さまざまな情報源の相対的価値を評価する際，Ball and Brown (1968)は， <span class="math inline">TI</span> ， <span class="math inline">NI</span> ， <span class="math inline">II</span> として示される3つのポートフォリオの構築方法を考慮している（Ball and Brown (2019)は <span class="math inline">II</span> を <span class="math inline">AI</span> として示しており，以下ではこの表記に従う）。</p>
<!-- Using these metrics, Ball and Brown (1968, p.1)  conclude that “of all the information about an individual firm which becomes available during a year, one-half or more is captured in that year’s income number. -->
<p>これらのメトリクスを使用して，Ball and Brown (1968, p.1) は「1年間に個々の企業に関するすべての情報のうち，半分以上がその年の収益数値に含まれている」と結論づけている。 <!-- … However, the annual income report does not rate highly as a timely medium, since most of its content (about 85 to 90 per cent) is captured by more prompt media which perhaps include interim reports.”3 --> … ただし，年次の収益報告書はタイムリーな媒体として高く評価されていない。なぜなら，その内容の大部分（約85〜90％）は，中間報告書を含むより迅速な媒体によって把握されているからである。」</p>
<!-- The third principal result is shown in Table 5, where we see that the income surprise is correlated with the API to a statistically significant extent in each month up to two months after the earnings announcement.4 -->
<p>3番目の主要な結果は，表5に示されており，収益サプライズは，収益発表後2ヶ月までの各月において，APIと統計的に有意な程度で相関していることがわかる。</p>
<!-- This result, which later become known as post-earnings announcement drift (or simply PEAD), was troubling to Ball and Brown (1968), who argue that some of it may be explained by “peak-ahead” in the measure of market income and transaction costs causing delays in trade. -->
<p>この結果は，後に収益発表後のドリフト（または単にPEAD）として知られるようになり，Ball and Brown (1968)にとって問題となっていた。彼らは，市場収益の「ピーク・アヘッド」と取引コストによる取引の遅延が一部説明できる可能性があると主張している。 <!-- We study PEAD more closely in Chapter 14. --> PEADについては，第14章で詳しく検討する。</p>
<!-- ### 11.1.1 Discussion questions -->
<section id="ディスカッション課題" class="level3" data-number="4.1.1"><h3 data-number="4.1.1" class="anchored" data-anchor-id="ディスカッション課題">
<span class="header-section-number">4.1.1</span> ディスカッション課題</h3>
<!-- 1. What is the research question of Ball and Brown (1968)? -->
<ol type="1">
<li>Ball and Brown (1968)の研究課題は何か？ <!-- Do you find the paper to be persuasive? --> この論文は説得力がありますか？</li>
</ol>
<!-- 2. What do you notice about the references in Ball and Brown (1968, pp. 177–178)? --><ol start="2" type="1">
<li>Ball and Brown (1968, pp.&nbsp;177–178)の参考文献について気づいたことは何ですか？</li>
</ol>
<!-- 3. Given that “the most fundamental result” of Ball and Brown (1968) relates to an association or correlation, is it correct to say that the paper provides no evidence on causal linkages?  --><ol start="3" type="1">
<li>Ball and Brown (1968)の「最も基本的な結果」が関連性または相関に関するものであることを踏まえると、この論文が因果関係についての証拠を提供していないと言うのは正しいのか？ <!-- Does this also mean that Ball and Brown (1968) is a “merely” descriptive paper according to the taxonomy of research papers outlined in Chapter 4. --> これは，第4章で概説された研究論文の分類に従うと，Ball and Brown (1968)が「単なる」記述的論文であるということを意味するでしょうか？[^4] <!-- How might the results of Ball and Brown (1968) be represented in a causal diagram assuming that accounting information is meaningful and markets are efficient? --> 会計情報が意味を持ち，市場が効率的であると仮定した場合，Ball and Brown (1968)の結果はどのように因果図で表現されるでしょうか？ <!-- Would an alternative causal diagram be assumed by a critic who viewed accounting information as meaningless? --> 会計情報を無意味と見なす批評家は，どのような代替の因果図を仮定するでしょうか？</li>
</ol>
<!-- 4. Describe how Figure 1 of Ball and Brown (1968) supports each of principal results identified by Ball and Brown (2019). --><ol start="4" type="1">
<li>Ball and Brown (2019)が特定した主要な結果それぞれを，Ball and Brown (1968)の図1がどのように支持しているかを説明してください。</li>
</ol>
<!-- 5. Consider the causal diagrams you created above. Do the results of Ball and Brown (1968) provide more support for one causal diagram than the other? --><ol start="5" type="1">
<li>Ball and Brown (1968)の結果は，上で作成した因果関係図のうち、どちら一方をより強く支持しているといえるのか？</li>
</ol>
<!-- 6. Compare Figure 1 of Ball and Brown (2019) with Figure 1 of BB68. What is common between the two figures? What is different? --><ol start="6" type="1">
<li>Ball and Brown (2019)の図1とBall and Brown (1968)の図1を比較しなさい。これら2つの図の共通点は何か？異なる点は何か？</li>
</ol>
<!-- 7. What does “less their average” mean in the title of Figure 1 of Ball and Brown (2019)?  --><ol start="7" type="1">
<li>Ball and Brown (2019)の図1のタイトルにある「less their average」とは何を意味するか？ <!-- What effect does this have on the plot?  --> このプロットにどのような影響を与えるか？ –&gt; <!-- (Does it make this plot different from Figure 1 of BB68? Is information lost in the process?) --> （このプロットはBall and Brown (1968)の図1と異なるものか？ このプロセスで情報が失われているのか？）</li>
</ol>
<!-- 8. Ball and Brown (2019, p. 418) say “in this replication we address two issues with the BB68 significance tests.” Do you understand the points being made here? --><ol start="8" type="1">
<li>Ball and Brown (2019, p.&nbsp;418)は「このレプリケーションでは，Ball and Brown (1968)の有意性検定に関する2つの問題に取り組んでいる」と述べている。ここで述べられているポイントを理解できますか？</li>
</ol>
<!-- 9.  Ball and Brown (2019, p. 418) also say “the persistence of PEAD over time is evidence it does not constitute market inefficiency.” What do you make of this argument? --><ol start="9" type="1">
<li>Ball and Brown (2019, p.&nbsp;418)はまた「PEADの時間経過に伴う持続性は，それが市場の非効率性を構成していないことの証拠である」と述べている。この議論についてどう思いますか？</li>
</ol>
<!-- 10. What is the minimum amount of information that our hypothetical genie needs to provide to enable formation of the portfolios underlying TI, NI, and II? What are the rules for construction of each of these portfolios? --><ol start="10" type="1">
<li>
<span class="math inline">TI</span> 、<span class="math inline">NI</span> 、 <span class="math inline">II</span> の基礎となるポートフォリオを形成するために，仮想的な妖精さんが提供する必要がある最小限の情報は何ですか？ これらのポートフォリオの構築にはどのようなルールがありますか？</li>
</ol>
<!-- 11. Ball and Brown (1968) observe a ratio of NI to TI of about $0.23$ . What do we expect this ratio to be? Does this ratio depend on the information content of accounting information? --><ol start="11" type="1">
<li>Ball and Brown (1968)は，<span class="math inline">NI</span> と <span class="math inline">TI</span> の比率が約 <span class="math inline">0.23</span> であることを観察している。この比率はどのようになると予想されますか？この比率は会計情報の情報内容に依存するのでしょうか？</li>
</ol>
<!-- 12. Consider the paragraph in Ball and Brown (2019, p. 418) beginning “an innovation in BB68 was to estimate …”. How do the discussions of these results differ between Ball and Brown (1968) and Ball and Brown (2019)? --><ol start="12" type="1">
<li>Ball and Brown (2019, p.&nbsp;418)の「Ball and Brown (1968)のイノベーションは，…」という段落を考えなさい。 これらの結果に関する議論は，Ball and Brown (1968)とBall and Brown (2019)の間でどのように異なるか？</li>
</ol>
<!-- 13. Consider column (4) of Table 2 of Ball and Brown (2019).Is an equivalent set of numbers reported in BB68? What is the underlying investment strategy associated with this column (this need not be feasible in practice)? --><ol start="13" type="1">
<li>Ball and Brown (2019)の表2の列（4）を考えなさい。 Ball and Brown (1968)で同等の数値が報告されているか？ この列に関連付けられた基礎となる投資戦略は何か（これは現実に実現可能である必要はあるか）？</li>
</ol>
<!-- 15. Heading 6.3 of Ball and Brown (2019) is “Does ‘useful’ disprove ‘meaningless’?”  --><ol start="14" type="1">
<li>Ball and Brown (2019)の6.3節の見出しは「『useful』は『meaningless』を否定するか？」である。 <!-- Do you think that “not meaningless” implies “not useless”?  --> 「『無意味』でない」ということは「『無用』でない」ということを意味すると思か？ <!-- Which questions (or facts) does BB68 address in these terms? --> Ball and Brown (1968)がこれらの観点でどのような問題（または事実）に取り組んでいるか。</li>
</ol></section></section><section id="ball-and-brown-1968の再現" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="ball-and-brown-1968の再現">
<span class="header-section-number">4.2</span> Ball and Brown (1968)の再現</h2>
<!-- In this section, we follow Nichols and Wahlen (2004) in conducting an updated replication of Ball and Brown (1968). -->
<p>この章では，Nichols and Wahlen (2004)に倣って，Ball and Brown (1968)の最新のレプリケーションを行う。</p>
<!-- We get earnings and returns data from Compustat and CRSP, respectively. -->
<p>利益とリターンのデータは，それぞれCompustatとCRSPから取得する。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">PostgreSQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">parquet</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> dbConnec<span class="co">#| t(RPostgres::Postgres(),</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                bigint <span class="ot">=</span> <span class="st">"integer"</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                check_interrupts <span class="ot">=</span> <span class="cn">TRUE</span><span class="er">)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>msf <span class="ot">&lt;-</span> <span class="fu">tbl</span>(db, <span class="fu">Id</span>(<span class="at">schema =</span> <span class="st">"crsp"</span>, <span class="at">table =</span> <span class="st">"msf"</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>msi <span class="ot">&lt;-</span> <span class="fu">tbl</span>(db, <span class="fu">Id</span>(<span class="at">schema =</span> <span class="st">"crsp"</span>, <span class="at">table =</span> <span class="st">"msi"</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>ccmxpf_lnkhist <span class="ot">&lt;-</span> <span class="fu">tbl</span>(db, <span class="fu">Id</span>(<span class="at">schema =</span> <span class="st">"crsp"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">table =</span> <span class="st">"ccmxpf_lnkhist"</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>stocknames <span class="ot">&lt;-</span> <span class="fu">tbl</span>(db, <span class="fu">Id</span>(<span class="at">schema =</span> <span class="st">"crsp"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">table =</span> <span class="st">"stocknames"</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>funda <span class="ot">&lt;-</span> <span class="fu">tbl</span>(db, <span class="fu">Id</span>(<span class="at">schema =</span> <span class="st">"comp"</span>, <span class="at">table =</span> <span class="st">"funda"</span>))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>fundq <span class="ot">&lt;-</span> <span class="fu">tbl</span>(db, <span class="fu">Id</span>(<span class="at">schema =</span> <span class="st">"comp"</span>, <span class="at">table =</span> <span class="st">"fundq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html">duckdb</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">msf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/farr/man/load_parquet.html">load_parquet</a></span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"msf"</span><span class="op">)</span></span>
<span><span class="va">msi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/farr/man/load_parquet.html">load_parquet</a></span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"crsp"</span>, table <span class="op">=</span> <span class="st">"msi"</span><span class="op">)</span></span>
<span><span class="va">ccmxpf_lnkhist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/farr/man/load_parquet.html">load_parquet</a></span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"crsp"</span>,</span>
<span>                               table <span class="op">=</span> <span class="st">"ccmxpf_lnkhist"</span><span class="op">)</span></span>
<span><span class="va">stocknames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/farr/man/load_parquet.html">load_parquet</a></span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"crsp"</span>,</span>
<span>                               table <span class="op">=</span> <span class="st">"stocknames"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">funda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/farr/man/load_parquet.html">load_parquet</a></span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"comp"</span>, table <span class="op">=</span> <span class="st">"funda"</span><span class="op">)</span></span>
<span><span class="va">fundq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/farr/man/load_parquet.html">load_parquet</a></span><span class="op">(</span><span class="va">db</span>, schema <span class="op">=</span> <span class="st">"comp"</span>, table <span class="op">=</span> <span class="st">"fundq"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<!-- 11.2.1 Announcement dates and returns data -->
<section id="発表日とリターンデータ" class="level3" data-number="4.2.1"><h3 data-number="4.2.1" class="anchored" data-anchor-id="発表日とリターンデータ">
<span class="header-section-number">4.2.1</span> 発表日とリターンデータ</h3>
<!-- Getting earnings announcement dates involved significant data-collection effort for Ball and Brown (1968).  -->
<p>Ball and Brown (1968)の収益発表日を取得するためには，かなりのデータ収集作業が必要であった。 <!-- Fortunately, as discussed in Ball and Brown (2019), quarterly Compustat (comp.fundq) has data on earnings announcement dates from roughly 1971 onwards.  --> 幸いなことに，Ball and Brown (2019)で議論されているように，四半期Compustat(<code>comp.fundq</code>)には，1971年以降の利益発表日のデータがある。 <!-- Like Ball and Brown (1968), we are only interested in fourth quarters and firms with 31 December year-ends.  --> Ball and Brown (1968)と同様に，我々は四半期と12月31日の年度末を持つ企業に関心がある。 <!-- Because we will need to line up these dates with data from monthly CRSP (crsp.msf), we create an annc_month variable. --> これらの日付を月次CRSP(<code>crsp.msf</code>)のデータと整合させる必要があるため，<code>annc_month</code>変数を作成する。</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">annc_events</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fundq</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">indfmt</span> <span class="op">==</span> <span class="st">"INDL"</span>, <span class="va">datafmt</span> <span class="op">==</span> <span class="st">"STD"</span>,</span>
<span>         <span class="va">consol</span> <span class="op">==</span> <span class="st">"C"</span>, <span class="va">popsrc</span> <span class="op">==</span> <span class="st">"D"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">fqtr</span> <span class="op">==</span> <span class="fl">4</span>, <span class="va">fyr</span> <span class="op">==</span> <span class="fl">12</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">rdq</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gvkey</span>, <span class="va">datadate</span>, <span class="va">rdq</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>annc_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span><span class="va">rdq</span>, unit <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- To compile returns for months $t-11$ through $t+6$ for each earnings announcement date ($t$) (as Ball and Brown (1968) and Nichols and Wahlen (2004) do), we will need the date values on CRSP associated with each of those months. -->
<p>Ball and Brown (1968)やNichols and Wahlen (2004)が行うように，各利益発表時点（<span class="math inline">t</span>）の <span class="math inline">t-11</span> 月から <span class="math inline">t+6</span> 月までのリターンを集計するためには，それらの月に関連付けられたCRSPの日付値が必要となる。</p>
<!-- We will create a table td_link that will provide the link between announcement events in annc_events and dates on CRSP’s monthly stock file (crsp.msf). -->
<p><code>annc_events</code>とCRSPの月次株式ファイル（<code>crsp.msf</code>）の日付とのリンクを提供する<code>td_link</code>というテーブルを作成する。</p>
<!-- The first step is to create a table (crsp_dates) that orders the dates on monthly CRSP and assigns each month a corresponding “trading date” value (td), which is 1 for the first month, 2 for the second month, and so on. -->
<p>最初のステップは，月次CRSPの日付を順序付け，各月に対応する「取引日」値（<code>td</code>）を割り当てるテーブル（<code>crsp_dates</code>）を作成することである。最初の月には1，2番目の月には2，といった具合である。 <!-- Because the date values on crsp.msf line up with the date values on crsp.msi, we can use the latter (much smaller) table. --> <code>crsp.msf</code>の日付値は<code>crsp.msi</code>の日付値と整合しているため，後者（はるかに小さい）のテーブルを使用することができる。</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">crsp_dates</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">msi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dbplyr.tidyverse.org/reference/window_order.html">window_order</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>td <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span><span class="va">date</span>, unit <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">crsp_dates</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We want to construct a table that allows us to link earnings announcements (annc_events) with returns from crsp.msf Because we are only interested in months where returns are available, we can obtain the set of potential announcement months from crsp_dates. The table annc_months has each value of annc_month and its corresponding annc_td from crsp_dates, along with the boundaries of the window that contains all values of td within the range <span class="math inline">(t-11, t+6)</span>, where <span class="math inline">t</span> is the announcement month.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">annc_months</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">crsp_dates</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">td</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>annc_month <span class="op">=</span> <span class="va">month</span>, annc_td <span class="op">=</span> <span class="va">td</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>start_td <span class="op">=</span> <span class="va">annc_td</span> <span class="op">-</span> <span class="fl">11L</span>,</span>
<span>         end_td <span class="op">=</span> <span class="va">annc_td</span> <span class="op">+</span> <span class="fl">6L</span><span class="op">)</span></span>
<span></span>
<span><span class="va">annc_months</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We can then join annc_months with crsp_dates to create the table td_link. -->
<p>次に，<code>annc_months</code>を<code>crsp_dates</code>と結合して，<code>td_link</code>テーブルを作成する。</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">td_link</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">crsp_dates</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">annc_months</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html">join_by</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="va">td</span>, <span class="va">start_td</span>, <span class="va">end_td</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rel_td <span class="op">=</span> <span class="va">td</span> <span class="op">-</span> <span class="va">annc_td</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">annc_month</span>, <span class="va">rel_td</span>, <span class="va">date</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Here are the data for one annc_month: -->
<p>以下は，1つの<code>annc_month</code>のデータである。</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">td_link</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">annc_month</span> <span class="op">==</span> <span class="st">"2001-04-01"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- We use ccm_link (as used in Chapter 7) to connect earnings announcement dates on Compustat with returns from CRSP. -->
<p>Compustatの収益発表日とCRSPのリターンを結びつけるために，<code>ccm_link</code>（第7章で使用）を使用する。</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ccm_link</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">ccmxpf_lnkhist</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">linktype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LC"</span>, <span class="st">"LU"</span>, <span class="st">"LS"</span><span class="op">)</span>,</span>
<span>         <span class="va">linkprim</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>permno <span class="op">=</span> <span class="va">lpermno</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>linkenddt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html">coalesce</a></span><span class="op">(</span><span class="va">linkenddt</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">linkenddt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gvkey</span>, <span class="va">permno</span>, <span class="va">linkdt</span>, <span class="va">linkenddt</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Nichols and Wahlen (2004) focus on firms listed on NYSE, AMEX, and NASDAQ, which correspond to firms with exchcd values of 1, 2, and 3, respectively. -->
<p>Nichols and Wahlen (2004)は，NYSE，AMEX，NASDAQに上場している企業に焦点を当てており，それぞれ<code>exchcd</code>値が1，2，3に対応している。 <!-- The value of `exchcd` for each firm at each point in time is found on crsp.stocknames.  --> 各企業の各時点での<code>exchcd</code>の値は<code>crsp.stocknames</code>にある。 <!-- Following Nichols and Wahlen (2004), we get data on fiscal years from 1988 to 2002 (2004, p. 270). --> Nichols and Wahlen (2004)に倣って，1988年から2002年までの財務年度のデータを取得する。</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rets_all</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">annc_events</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">td_link</span>, by <span class="op">=</span> <span class="st">"annc_month"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">ccm_link</span>, by <span class="op">=</span> <span class="st">"gvkey"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">annc_month</span> <span class="op">&gt;=</span> <span class="va">linkdt</span>, <span class="va">annc_month</span> <span class="op">&lt;=</span> <span class="va">linkenddt</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">msf</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"permno"</span>, <span class="st">"date"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span></span>
<span>    <span class="va">stocknames</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">exchcd</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html">join_by</a></span><span class="op">(</span><span class="va">permno</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">namedt</span>, <span class="va">nameenddt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gvkey</span>, <span class="va">datadate</span>, <span class="va">rel_td</span>, <span class="va">permno</span>, <span class="va">date</span>, <span class="va">ret</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">datadate</span><span class="op">)</span>, <span class="fl">1987L</span>, <span class="fl">2002L</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- To keep things straightforward, we focus on firms that have returns for each month in the $(t-11, t+6)$ window and the table full_panel identifies these firms. -->
<p>わかりやすくするために，<span class="math inline">(t-11, t+6)</span>のウィンドウ内の各月にリターンを持つ企業に焦点を当て，<code>full_panel</code>テーブルがこれらの企業を特定する。</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">full_panel</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">rets_all</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gvkey</span>, <span class="va">datadate</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n_obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n_obs</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gvkey</span>, <span class="va">datadate</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rets</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">rets_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span><span class="va">full_panel</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gvkey"</span>, <span class="st">"datadate"</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Note that, unlike other early papers (e.g., Beaver, 1968; Fama et al., 1969), Ball and Brown (1968) do not exclude observations due to known confounding events.5 -->
<p>他の初期の論文（例：Beaver, 1968; Fama et al., 1969）とは異なり，Ball and Brown (1968)は既知の交絡事象による観測値を除外していないことに注意されたい。[^5]</p>
<!-- ### 11.2.2 Data on size-portfolio returns -->
</section><section id="サイズポートフォリオリターンのデータ" class="level3" data-number="4.2.2"><h3 data-number="4.2.2" class="anchored" data-anchor-id="サイズポートフォリオリターンのデータ">
<span class="header-section-number">4.2.2</span> サイズポートフォリオリターンのデータ</h3>
<!-- Ball and Brown (1968) focus on abnormal returns and estimate a market model with firm-specific coefficients as the basis for estimating residual returns, which they denote API.  -->
<p>Ball and Brown (1968)は異常リターンに焦点を当て，企業固有の係数を持つ市場モデルを推定し，残差リターンを推定する基礎として，これを <span class="math inline">API</span> として示している。 <!-- The use of residuals from a market model addresses a concern about cross-sectional correlation that would arise if raw returns were used. --> 市場モデルからの残差の使用は，生のリターンが使用された場合に生じるクロスセクションの相関に関する懸念に対処している。 <!-- Ball and Brown (1968) note that about 10% of returns are due to industry factors, but conclude that the likely impact of this on inference is likely to be small. --> Ball and Brown (1968)は，約10%のリターンが産業要因によるものであるが，これが推論に与える影響は小さいと結論づけている。</p>
<!-- In contrast, Nichols and Wahlen (2004) use size-adjusted returns as their measure of abnormal returns.  -->
<p>一方，Nichols and Wahlen (2004)は，異常リターンの尺度としてサイズ調整リターンを使用している。 <!-- To calculate size-adjusted returns, we get two kinds of data from the website of Ken French (as seen in Chapter 9). --> サイズ調整リターンを計算するために，（第9章で見たように）Ken Frenchのウェブサイトから2種類のデータを取得する。</p>
<!-- First, we get data on size-decile returns.  -->
<p>まず，規模の十分位リターンのデータを取得する。 <!-- Ken French’s website supplies a comma-delimited text file containing monthly and annual data for value-weighted and equal-weighted portfolio returns. --> Ken Frenchのウェブサイトは，月次と年次の加重と等加重のポートフォリオ・リターンに対するコンマ区切りのテキストファイルを提供している。</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="st">"Portfolios_Formed_on_ME_CSV.zip"</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"http://mba.tuck.dartmouth.edu"</span>,</span>
<span>             <span class="st">"/pages/faculty/ken.french/ftp/"</span>,</span>
<span>             <span class="st">"Portfolios_Formed_on_ME_CSV.zip"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="va">url</span>, <span class="va">t</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- From inspection of the downloaded text file, we observe that there are several data sets in this file.  -->
<p>ダウンロードしたテキストファイルを確認すると，このファイルにはいくつかのデータセットが含まれていることがわかる。 <!-- We want monthly returns and will extract both value-weighted and equal-weighted data.  --> 月次リターンを取得し，時価総額加重リターンと等加重リターンの両方のデータを抽出する。 <!-- We see that the equal-weighted returns begin with a row starting with text Equal Weight Returns -- Monthly and end a few rows before a row starting with text Value Weight Returns -- Annual. --> 等加重リターンのデータは、<code>Equal Weight Returns – Monthly</code>という文字列で始まる行から始まり、<code>Value Weight Returns – Annual</code>という文字列で始まる行の数行手前で終わっている。</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Determine breakpoints (lines) for different tables</span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_lines.html">read_lines</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="va">vw_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_which.html">str_which</a></span><span class="op">(</span><span class="va">temp</span>, <span class="st">"^\\s+Value Weight Returns -- Monthly"</span><span class="op">)</span></span>
<span><span class="va">vw_end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_which.html">str_which</a></span><span class="op">(</span><span class="va">temp</span>, <span class="st">"^\\s+Equal Weight Returns -- Monthly"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="va">ew_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_which.html">str_which</a></span><span class="op">(</span><span class="va">temp</span>, <span class="st">"^\\s+Equal Weight Returns -- Monthly"</span><span class="op">)</span></span>
<span><span class="va">ew_end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_which.html">str_which</a></span><span class="op">(</span><span class="va">temp</span>, <span class="st">"^\\s+Value Weight Returns -- Annual"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Having identified these separating rows, we can use the following function to read in the data set and organize the associated data tables appropriately.  -->
<p>これらの区切り行を特定したら，次の関数を使用してデータセットを読み込み，関連するデータテーブルを適切に整理することができる。 <!-- Note that NA values are represented as -99.99 in the text files and that the dates have a form yyyymm that we convert to dates of form yyyy-mm-01, which we call month. --> このテキストファイルではNA値は<code>-99.99</code>として表されており，日付は<code>yyyymm</code>の形式であり，これを<code>yyyy-mm-01</code>の形式の日付に変換し，<code>month</code>とする。</p>
<!-- While the original data come in a “wide” format with returns at every fifth percentile, we rearrange the data into a “long” format, retain only the deciles (i.e., every tenth percentile), and rename the decile labels from Lo 10, Dec 2, …, Dec 9, and Hi 10 to 1, 2, …, 9, and 10. -->
<p>元のデータは，5パーセンタイルごとにリターンがある「ワイド」形式で提供されているが，データを「ロング」形式に再配置し，十分位（つまり10パーセンタイルごと）のみを保持し，デシルラベルを<code>Lo 10</code>，<code>Dec 2</code>，…，<code>Dec 9</code>，<code>Hi 10</code>から<code>1，2，…，9，10</code>に変更する。</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">read_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>VROOM_CONNECTION_SIZE <span class="op">=</span> <span class="fl">500000</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fix_names</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">names</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">names</span>, <span class="st">"^$"</span>, <span class="st">"date"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">t</span>, skip <span class="op">=</span> <span class="va">start</span>, n_max <span class="op">=</span> <span class="va">end</span> <span class="op">-</span> <span class="va">start</span>,</span>
<span>           na <span class="op">=</span> <span class="st">"-99.99"</span>,</span>
<span>           name_repair <span class="op">=</span> <span class="va">fix_names</span>,</span>
<span>           show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">date</span>, <span class="st">"01"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"quantile"</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"ret"</span>,</span>
<span>                 cols <span class="op">=</span> <span class="op">-</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ret <span class="op">=</span> <span class="va">ret</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>           decile <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">quantile</span> <span class="op">==</span> <span class="st">"Hi 10"</span> <span class="op">~</span> <span class="st">"10"</span>,</span>
<span>                              <span class="va">quantile</span> <span class="op">==</span> <span class="st">"Lo 10"</span> <span class="op">~</span> <span class="st">"1"</span>,</span>
<span>                              <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">quantile</span>, <span class="st">"^Dec "</span><span class="op">)</span> <span class="op">~</span></span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^Dec "</span>, <span class="st">""</span>, <span class="va">quantile</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           decile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">decile</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">decile</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">quantile</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Now we can apply this function to extract the relevant data, which we combine into a single data frame size_rets. -->
<p>この関数を適用して関連データを抽出し，これらを1つのデータフレーム<code>size_rets</code>に結合することができる。</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vw_rets</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">read_data</span><span class="op">(</span><span class="va">vw_start</span>, <span class="va">vw_end</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>vw_ret <span class="op">=</span> <span class="va">ret</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ew_rets</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">read_data</span><span class="op">(</span><span class="va">ew_start</span>, <span class="va">ew_end</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>ew_ret <span class="op">=</span> <span class="va">ret</span><span class="op">)</span></span>
<span></span>
<span><span class="va">size_rets</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">ew_rets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">vw_rets</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"month"</span>, <span class="st">"decile"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">decile</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">size_rets</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,820 × 4
   month      decile  ew_ret  vw_ret
   &lt;date&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 1926-07-01      1 -0.0142 -0.0012
 2 1926-07-01      2  0.0029  0.0052
 3 1926-07-01      3 -0.0015 -0.0005
 4 1926-07-01      4  0.0088  0.0082
 5 1926-07-01      5  0.0145  0.0139
 6 1926-07-01      6  0.0185  0.0189
 7 1926-07-01      7  0.0163  0.0162
 8 1926-07-01      8  0.0138  0.0129
 9 1926-07-01      9  0.0338  0.0353
10 1926-07-01     10  0.0329  0.0371
# ℹ 11,810 more rows</code></pre>
</div>
</div>
<p>The second set of data we need to get from Ken French’s website is data on the cut-offs we will use in assigning firms to decile portfolios in calculating size-adjusted returns.</p>
<p>Again the original data come in a “wide” format with cut-offs at every fifth percentile, so again we rearrange the data into a “long” format, retain only the deciles (i.e., every tenth percentile), and rename the decile labels from p10, p20, …, p90, and p100, to 1, 2, …, 9, and 10.6 Also, we are only interested in the cut-offs for December in each year and use filter() to retain only these.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">me_breakpoints_raw</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">t</span>, skip <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"month"</span>, <span class="st">"n"</span>,</span>
<span>                         <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">5</span>, to <span class="op">=</span> <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           col_types <span class="op">=</span> <span class="st">"c"</span>,</span>
<span>           n_max <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_which.html">str_which</a></span><span class="op">(</span><span class="va">temp</span>, <span class="st">"^Copyright"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">month</span>, <span class="st">"01"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"5"</span><span class="op">)</span>, <span class="op">-</span><span class="va">n</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span> <span class="va">month</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"decile"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"cutoff"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>decile <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">decile</span>, <span class="st">"^p(.*)0$"</span>, <span class="st">"\\1"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>decile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">decile</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we organize the data to facilitate their use in joining with other data. Specifically, we create variables for the range of values covered by each decile (from me_min to me_max). We specify the minimum value for the first decile as zero and the maximum value for the tenth decile to infinity (Inf).</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/so-ichi\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./chap10_FFJR.html" class="pagination-link" aria-label="FFJR">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">FFJR</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chap12_Beaver1968.html" class="pagination-link" aria-label="Beaver (1968)">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Beaver (1968)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Soichi Matsuura</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ma2ura">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/matsuura_rits">
      <i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>